(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,87735,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),r=e.i(57688),n=e.i(22724),i=e.i(37963),l=e.i(92006),o=e.i(73134);let d=function({profilePath:e}){let[s,n]=(0,a.useState)(""),i=(0,a.useMemo)(()=>{if(!e)return"";let t=window.location.origin,a=e.startsWith("/")?e:`/${e}`;return`${t}${a}`},[e]);return(0,a.useEffect)(()=>{let e=!1;return i?(o.default.toDataURL(i,{errorCorrectionLevel:"M",margin:1,width:320}).then(t=>{e||n(t)}).catch(()=>{e||n("")}),()=>{e=!0}):void n("")},[i]),(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-3",children:[(0,t.jsx)("div",{className:"w-40 h-40 bg-white rounded-lg flex items-center justify-center border border-gray-200",children:s?(0,t.jsx)(r.default,{width:320,height:320,src:s,alt:"Mã QR hồ sơ",className:"w-full h-full rounded-lg"}):(0,t.jsx)("span",{className:"text-gray-400 text-sm",children:"Đang tạo QR…"})}),(0,t.jsx)("p",{className:"text-sm text-gray-500 text-center md:text-base",children:"Mã QR để người khác kết bạn hoặc xem hồ sơ của bạn."})]})};var c=e.i(74842);function x(){let e=(0,c.useToast)(),[s,r]=(0,a.useState)(""),[n,i]=(0,a.useState)(""),[l,o]=(0,a.useState)(""),[d,x]=(0,a.useState)(!1),h=async()=>{if(!n||n!==l)return void e({type:"error",message:"Mật khẩu xác nhận không khớp"});try{x(!0);let t=localStorage.getItem("info_user"),a=t?JSON.parse(t):null,l=String(a?._id||""),d=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"changePassword",data:{userId:l,currentPassword:s,newPassword:n}})}),c=await d.json();if(!d.ok||!c.success)return void e({type:"error",message:c.message||"Đổi mật khẩu thất bại"});e({type:"success",message:"Đổi mật khẩu thành công"}),r(""),i(""),o("")}finally{x(!1)}};return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("input",{type:"password",placeholder:"Mật khẩu hiện tại",value:s,onChange:e=>r(e.target.value),className:"w-full px-4 py-3 bg-white border border-gray-200 rounded-xl text-gray-800"}),(0,t.jsx)("input",{type:"password",placeholder:"Mật khẩu mới",value:n,onChange:e=>i(e.target.value),className:"w-full px-4 py-3 bg-white border border-gray-200 rounded-xl text-gray-800"}),(0,t.jsx)("input",{type:"password",placeholder:"Xác nhận mật khẩu mới",value:l,onChange:e=>o(e.target.value),className:"w-full px-4 py-3 bg-white border border-gray-200 rounded-xl text-gray-800"}),(0,t.jsx)("button",{onClick:h,disabled:d,className:"cursor-pointer w-full px-4 py-3 rounded-xl bg-indigo-600 text-white font-semibold hover:bg-indigo-700 disabled:opacity-70",children:d?"Đang đổi...":"Đổi mật khẩu"})]})}function h(){let e=(0,c.useToast)(),[s,r]=(0,a.useState)({showOnline:!0,allowFriendRequests:!0,allowTagging:!0}),[n,i]=(0,a.useState)(null);(0,a.useEffect)(()=>{try{let e=localStorage.getItem("info_user"),t=e?JSON.parse(e):null,a=t?.privacy||null;a&&r(a)}catch{}},[]);let l=async(t,a)=>{try{i(String(a));let s=localStorage.getItem("info_user"),n=s?JSON.parse(s):null,l=String(n?._id||""),o=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"update",field:"_id",value:l,data:{privacy:t}})}),d=await o.json();if(!o.ok||d.error)return void e({type:"error",message:"Cập nhật thất bại"});try{let e=localStorage.getItem("info_user"),a=e?JSON.parse(e):null;a&&localStorage.setItem("info_user",JSON.stringify({...a,privacy:t}))}catch{}r(t),e({type:"success",message:"Đã lưu"})}finally{i(null)}},o=e=>{l({...s,[e]:!s[e]},e)};return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 rounded-xl",children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"Hiển thị trạng thái online"}),(0,t.jsx)("button",{onClick:()=>o("showOnline"),className:`px-3 py-1 rounded-lg text-sm ${s.showOnline?"bg-indigo-600 text-white":"bg-gray-200 text-gray-800"}`,children:"showOnline"===n?"...":s.showOnline?"Bật":"Tắt"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 rounded-xl",children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"Cho phép lời mời kết bạn"}),(0,t.jsx)("button",{onClick:()=>o("allowFriendRequests"),className:`px-3 py-1 rounded-lg text-sm ${s.allowFriendRequests?"bg-indigo-600 text-white":"bg-gray-200 text-gray-800"}`,children:"allowFriendRequests"===n?"...":s.allowFriendRequests?"Bật":"Tắt"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 rounded-xl",children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"Cho phép gắn thẻ @"}),(0,t.jsx)("button",{onClick:()=>o("allowTagging"),className:`px-3 py-1 rounded-lg text-sm ${s.allowTagging?"bg-indigo-600 text-white":"bg-gray-200 text-gray-800"}`,children:"allowTagging"===n?"...":s.allowTagging?"Bật":"Tắt"})]})]})}var m=e.i(91416);function g(){let e=(0,c.useToast)(),[s,r]=(0,a.useState)({soundEnabled:!0,desktopAlerts:!0,showPreview:!0}),[n,i]=(0,a.useState)(null),{playMessageSound:l}=(0,m.useChatNotifications)({});(0,a.useEffect)(()=>{try{let e=localStorage.getItem("info_user"),t=e?JSON.parse(e):null,a=t?.notifications||null;a&&r(a)}catch{}},[]);let o=async(t,a)=>{try{i(String(a));let s=localStorage.getItem("info_user"),n=s?JSON.parse(s):null,l=String(n?._id||""),o=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"update",field:"_id",value:l,data:{notifications:t}})}),d=await o.json();if(!o.ok||d.error)return void e({type:"error",message:"Cập nhật thất bại"});try{let e=localStorage.getItem("info_user"),a=e?JSON.parse(e):null;a&&localStorage.setItem("info_user",JSON.stringify({...a,notifications:t}))}catch{}r(t),e({type:"success",message:"Đã lưu"})}finally{i(null)}},d=e=>{o({...s,[e]:!s[e]},e)};return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 rounded-xl",children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"Âm thanh thông báo"}),(0,t.jsx)("button",{onClick:()=>d("soundEnabled"),className:`px-3 py-1 rounded-lg text-sm ${s.soundEnabled?"bg-indigo-600 text-white":"bg-gray-200 text-gray-800"}`,children:"soundEnabled"===n?"...":s.soundEnabled?"Bật":"Tắt"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 rounded-xl",children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"Thử âm thanh"}),(0,t.jsx)("button",{onClick:()=>{s.soundEnabled?l():e({type:"info",message:"Âm thanh đang tắt"})},className:"px-3 py-1 rounded-lg text-sm bg-indigo-600 text-white",children:"Phát “ting”"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 rounded-xl",children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"Hiện banner desktop"}),(0,t.jsx)("button",{onClick:()=>d("desktopAlerts"),className:`px-3 py-1 rounded-lg text-sm ${s.desktopAlerts?"bg-indigo-600 text-white":"bg-gray-200 text-gray-800"}`,children:"desktopAlerts"===n?"...":s.desktopAlerts?"Bật":"Tắt"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 rounded-xl",children:[(0,t.jsx)("span",{className:"text-gray-800 font-medium",children:"Hiển thị preview nội dung"}),(0,t.jsx)("button",{onClick:()=>d("showPreview"),className:`px-3 py-1 rounded-lg text-sm ${s.showPreview?"bg-indigo-600 text-white":"bg-gray-200 text-gray-800"}`,children:"showPreview"===n?"...":s.showPreview?"Bật":"Tắt"})]})]})}var u=e.i(50719);let b=function(){let[e,r]=(0,a.useState)(null),n=(0,s.useRouter)(),i={password:"Đổi mật khẩu",privacy:"Quyền riêng tư",notifications:"Cài đặt thông báo"},l=async()=>{try{await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"logout"})})}catch{}try{localStorage.removeItem("info_user"),localStorage.removeItem("remember_login")}catch{}n.push("/login")};return(0,t.jsxs)("div",{className:"space-y-3",children:[[{key:"password",label:"Đổi mật khẩu"},{key:"privacy",label:"Quyền riêng tư"},{key:"notifications",label:"Cài đặt thông báo"}].map(e=>(0,t.jsx)("button",{onClick:()=>r(e.key),className:"cursor-pointer w-full px-4 py-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg md:text-lg",children:e.label},e.key)),(0,t.jsxs)("button",{onClick:l,className:"cursor-pointer w-full px-4 py-3 text-left bg-red-50 hover:bg-red-100 rounded-lg md:text-lg text-red-600 inline-flex items-center gap-2",children:[(0,t.jsx)(u.HiOutlineLogout,{className:"w-5 h-5"})," Đăng xuất"]}),e&&(0,t.jsxs)("div",{className:"fixed inset-0 z-[9999]",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/40 h-[110%]",onClick:()=>r(null)}),(0,t.jsx)("div",{className:"hidden md:flex absolute inset-0 items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b-gray-300",children:[(0,t.jsx)("span",{className:"font-semibold text-gray-800",children:i[e]}),(0,t.jsx)("button",{onClick:()=>r(null),className:"cursor-pointer px-3 py-1 text-sm font-medium rounded-lg bg-gray-100 hover:bg-gray-200",children:"Đóng"})]}),(0,t.jsxs)("div",{className:"p-4",children:["password"===e&&(0,t.jsx)(x,{}),"privacy"===e&&(0,t.jsx)(h,{}),"notifications"===e&&(0,t.jsx)(g,{})]})]})}),(0,t.jsx)("div",{className:"md:hidden absolute inset-x-0 bottom-0 p-5",children:(0,t.jsxs)("div",{className:"bg-white rounded-t-2xl shadow-2xl overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b-gray-300 border-b",children:[(0,t.jsx)("span",{className:"font-semibold text-gray-800",children:i[e]}),(0,t.jsx)("button",{onClick:()=>r(null),className:"cursor-pointer px-3 py-1 text-sm font-medium rounded-lg bg-gray-100 hover:bg-gray-200",children:"Đóng"})]}),(0,t.jsxs)("div",{className:"p-4 max-h-[70vh] overflow-y-auto",children:["password"===e&&(0,t.jsx)(x,{}),"privacy"===e&&(0,t.jsx)(h,{}),"notifications"===e&&(0,t.jsx)(g,{})]})]})})]})]})};function p({data:e}){let a=[{id:1,name:"Ban lãnh đạo"},{id:2,name:"Quản lý"},{id:3,name:"Kinh doanh"},{id:4,name:"Thiết kế"},{id:5,name:"Sản xuất"},{id:6,name:"Sàn TMĐT"},{id:7,name:"Kế toán"},{id:8,name:"Kho TM"},{id:9,name:"HCNS"},{id:10,name:"Maketing"}].find(t=>t.id===Number(e.department))?.name||e.department||"Chưa cập nhật";return(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Thông tin cá nhân"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Giới tính"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium flex-1 text-right",children:e.gender||"Chưa cập nhật"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Ngày sinh"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium flex-1 text-right",children:e.birthday||"Chưa cập nhật"})]}),(0,t.jsxs)("div",{className:"py-2 border-b border-gray-100",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Điện thoại"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium flex-1 text-right",children:e.phone||"Chưa cập nhật"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-2 pl-32",children:"Số điện thoại chỉ hiển thị với người có lưu số bạn trong danh bạ máy"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Email"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium flex-1 text-right",children:e.email||"Chưa cập nhật"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Địa chỉ"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium flex-1 text-right",children:e.address||"Chưa cập nhật"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Phòng ban"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium flex-1 text-right",children:a})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Chức vụ"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium flex-1 text-right",children:e.title||"Chưa cập nhật"})]})]})]})}var y=e.i(14674);let f={user:(0,t.jsx)(y.HiUser,{className:"w-6 h-6 text-gray-500"}),phone:(0,t.jsx)(y.HiPhone,{className:"w-6 h-6 text-gray-500"}),calendar:(0,t.jsx)(y.HiCalendar,{className:"w-6 h-6 text-gray-500"}),email:(0,t.jsx)(y.HiEnvelope,{className:"w-6 h-6 text-gray-500"}),location:(0,t.jsx)(y.HiMapPin,{className:"w-6 h-6 text-gray-500"}),building:(0,t.jsx)(y.HiBuildingOffice2,{className:"w-6 h-6 text-gray-500"}),briefcase:(0,t.jsx)(y.HiBriefcase,{className:"w-6 h-6 text-gray-500"})};function j({icon:e,label:a,value:s,badge:r}){return(0,t.jsxs)("div",{className:"flex items-center justify-between bg-white rounded-2xl px-6 py-3 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[e?f[e]:null,(0,t.jsx)("span",{className:"text-gray-600 font-medium text-base",children:a})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"font-semibold text-gray-900 text-base",children:s}),r&&(0,t.jsx)("div",{className:"mt-1.5",children:r})]})]})}let N={1:{label:"Ban lãnh đạo",color:"bg-pink-100 text-pink-700"},2:{label:"Quản lý",color:"bg-purple-100 text-purple-700"},3:{label:"Kinh doanh",color:"bg-blue-100 text-blue-700"},4:{label:"Thiết kế",color:"bg-green-100 text-green-700"},5:{label:"Sản xuất",color:"bg-yellow-100 text-yellow-700"},6:{label:"Sàn TMĐT",color:"bg-orange-100 text-orange-700"},7:{label:"Kế toán",color:"bg-red-100 text-red-700"},8:{label:"Kho TM",color:"bg-gray-100 text-gray-700"},9:{label:"HCNS",color:"bg-teal-100 text-teal-700"},10:{label:"Maketing",color:"bg-pink-100 text-pink-700"}};function v({form:e}){let a=e.department?N[e.department]:void 0;return(0,t.jsxs)("div",{className:"space-y-4 max-w-2xl mx-auto",children:[(0,t.jsx)(j,{icon:"user",label:"Tên hiển thị",value:e.name||"Chưa đặt"}),(0,t.jsx)(j,{icon:"phone",label:"Số điện thoại",value:e.phone||"Chưa đặt"}),(0,t.jsx)(j,{icon:"user",label:"Giới tính",value:e.gender||"Chưa chọn"}),(0,t.jsx)(j,{icon:"calendar",label:"Ngày sinh",value:e.birthday||"Chưa chọn"}),(0,t.jsx)(j,{icon:"email",label:"Email",value:e.email||"Chưa đặt"}),(0,t.jsx)(j,{icon:"location",label:"Địa chỉ",value:e.address||"Chưa đặt"}),(0,t.jsx)(j,{icon:"building",label:"Phòng ban",value:a?.label||"Chưa xác định",badge:a&&(0,t.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${a.color}`,children:a.label})}),(0,t.jsx)(j,{icon:"briefcase",label:"Chức vụ",value:e.title||"Chưa đặt"})]})}function w({form:e,setForm:s,isSaving:r,onSave:n}){let[i,l]=(0,a.useState)(!1),[o,d]=(0,a.useState)(!1),c=[{id:1,name:"Ban lãnh đạo"},{id:2,name:"Quản lý"},{id:3,name:"Kinh doanh"},{id:4,name:"Thiết kế"},{id:5,name:"Sản xuất"},{id:6,name:"Sàn TMĐT"},{id:7,name:"Kế toán"},{id:8,name:"Kho TM"},{id:9,name:"HCNS"},{id:10,name:"Maketing"}];return(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Chỉnh sửa thông tin"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Tên hiển thị"}),(0,t.jsx)("input",{className:"flex-1 text-right text-gray-900 font-medium focus:outline-none placeholder-gray-400",value:e.name,onChange:t=>s({...e,name:t.target.value}),placeholder:"Chưa cập nhật"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Giới tính"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>l(!i),className:`
      w-full px-5 p-2 rounded-2xl  text-base font-medium text-left cursor-pointer
      flex items-center justify-between transition-all duration-200
      focus:outline-none
      ${i?"bg-white ring-4 ring-[#0068ff]/20 border-2 border-[#0068ff]":"border-2 border-transparent "}
      ${e.gender?"text-gray-900":"text-gray-500"}
    `,children:[(0,t.jsx)("span",{children:e.gender||"Chưa cập nhật"}),(0,t.jsx)(u.HiChevronDown,{className:`w-5 h-5 text-gray-500 transition-transform duration-300 ${i?"rotate-180":""}`})]}),i&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>l(!1)}),(0,t.jsx)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-2xl shadow-xl border border-gray-200 overflow-hidden z-50",children:["Nam","Nữ","Khác"].map(a=>(0,t.jsxs)("button",{type:"button",onClick:()=>{s({...e,gender:a}),l(!1)},className:`
              w-full px-5 py-4 text-left font-medium transition-all duration-150 cursor-pointer
              ${e.gender===a?"bg-[#0068ff]/5 text-[#0068ff]":"text-gray-800 hover:bg-gray-100"}
              active:bg-gray-200 flex items-center justify-between
            `,children:[(0,t.jsx)("span",{children:a}),e.gender===a&&(0,t.jsx)(y.HiCheck,{className:"w-5 h-5 text-[#0068ff]"})]},a))})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100 ",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Ngày sinh"}),(0,t.jsx)("input",{type:"date",className:"flex-1 text-right cursor-pointer text-gray-900 font-medium focus:outline-none bg-transparent",value:e.birthday,onChange:t=>s({...e,birthday:t.target.value})})]}),(0,t.jsxs)("div",{className:"py-2 border-b border-gray-100",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Điện thoại"}),(0,t.jsx)("input",{type:"tel",className:"flex-1 text-right text-gray-900 font-medium focus:outline-none placeholder-gray-400",value:e.phone,onChange:t=>s({...e,phone:t.target.value}),placeholder:"Chưa cập nhật"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-2 pl-32",children:"Số điện thoại chỉ hiển thị với người có lưu số bạn trong danh bạ máy"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Email"}),(0,t.jsx)("input",{type:"email",className:"flex-1 text-right text-gray-900 font-medium focus:outline-none placeholder-gray-400",value:e.email,onChange:t=>s({...e,email:t.target.value}),placeholder:"Chưa cập nhật"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Địa chỉ"}),(0,t.jsx)("input",{className:"flex-1 text-right text-gray-900 font-medium focus:outline-none placeholder-gray-400",value:e.address,onChange:t=>s({...e,address:t.target.value}),placeholder:"Chưa cập nhật"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-4 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 text-base w-32",children:"Phòng ban"}),(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>d(!o),className:`
        w-full px-4 py-1 text-right font-medium text-base transition-all duration-200 cursor-pointer
        flex items-center justify-end gap-3
        ${e.department?"text-gray-900":"text-gray-500"}
        focus:outline-none
      `,children:[(0,t.jsx)("span",{className:"truncate max-w-[180px]",children:c.find(t=>String(t.id)===e.department)?.name||"Chưa cập nhật"}),(0,t.jsx)(u.HiChevronDown,{className:`w-5 h-5 text-gray-500 transition-transform duration-300 flex-shrink-0 ${o?"rotate-180":""}`})]}),o&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>d(!1)}),(0,t.jsxs)("div",{className:"absolute h-[24rem] overflow-y-auto right-0 custom-scrollbar bottom-full mt-2 w-64 bg-white rounded-2xl shadow-xl border border-gray-200 overflow-hidden z-50",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>{s({...e,department:""}),d(!1)},className:`
              w-full px-5 py-4 text-left font-medium transition-all duration-150 cursor-pointer
              ${!e.department?"bg-[#0068ff]/5 text-[#0068ff]":"text-gray-800 hover:bg-gray-100"}
              active:bg-gray-200 flex items-center justify-between
            `,children:[(0,t.jsx)("span",{children:"Chưa cập nhật"}),!e.department&&(0,t.jsx)(y.HiCheck,{className:"w-5 h-5 text-[#0068ff]"})]}),c.map(a=>(0,t.jsxs)("button",{type:"button",onClick:()=>{s({...e,department:String(a.id)}),d(!1)},className:`
                w-full px-5 py-4 text-left font-medium transition-all duration-150 cursor-pointer border-t border-gray-100
                ${e.department===String(a.id)?"bg-[#0068ff]/5 text-[#0068ff]":"text-gray-800 hover:bg-gray-100"}
                active:bg-gray-200 flex items-center justify-between
              `,children:[(0,t.jsx)("span",{children:a.name}),e.department===String(a.id)&&(0,t.jsx)(y.HiCheck,{className:"w-5 h-5 text-[#0068ff]"})]},a.id))]})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Chức vụ"}),(0,t.jsx)("input",{className:"flex-1 text-right text-gray-900 font-medium focus:outline-none placeholder-gray-400",value:e.title,onChange:t=>s({...e,title:t.target.value}),placeholder:"Chưa cập nhật"})]})]}),(0,t.jsx)("button",{onClick:n,disabled:r,className:"w-full mt-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-semibold rounded-full shadow-sm transition-all duration-200 active:scale-95 flex items-center justify-center gap-2 cursor-pointer",children:r?"Đang lưu...":(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.HiCheck,{className:"w-5 h-5"}),"Lưu thông tin"]})})]})}function C({onDataChange:e,isOwner:r}){let n=(0,s.useSearchParams)(),i=(0,c.useToast)(),[l,o]=(0,a.useState)({name:"",phone:"",gender:"",birthday:"",email:"",address:"",department:"",title:""}),[d,x]=(0,a.useState)(!1),[h,m]=(0,a.useState)(!1),[g,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{u(!0)},[]);let b=(0,a.useMemo)(()=>{try{let e=localStorage.getItem("info_user");return e?JSON.parse(e):null}catch{return null}},[]),p=(0,a.useMemo)(()=>String(b?.username||b?._id||""),[b]),f=n.get("user")||"",j=r??(p&&f&&p===f),N=(0,a.useRef)(!1);(0,a.useEffect)(()=>{if(N.current||!b)return;let t={name:String(b.name||b.username||""),phone:String(b.phone||""),gender:String(b.gender||""),birthday:String(b.birthday||""),email:String(b.email||""),address:String(b.address||""),department:String(b.department||""),title:String(b.title||"")};o(t),N.current=!0,e?.(t)},[b,e]);let C=async()=>{if(j){x(!0);try{let t=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"update",field:b?.username?"username":"_id",value:p,data:l})}),a=await t.json();if(!t.ok||a.error)throw Error(a.error||"Lưu thất bại");localStorage.setItem("info_user",JSON.stringify({...b,...l})),e?.(l),i({type:"success",message:"Đã lưu thông tin!"}),m(!1)}catch(e){i({type:"error",message:e.message||"Lỗi hệ thống"})}finally{x(!1)}}};if(!g)return null;if(!j)return(0,t.jsx)(v,{form:l});if(h)return(0,t.jsx)(w,{form:l,setForm:o,isSaving:d,onSave:C});let S=[{id:2,name:"Quản lý"},{id:3,name:"Kinh doanh"},{id:4,name:"Thiết kế"},{id:5,name:"Sản xuất"},{id:6,name:"Sàn TMĐT"},{id:7,name:"Kế toán"},{id:8,name:"Kho TM"},{id:9,name:"HCNS"},{id:10,name:"Maketing"}].find(e=>e.id===Number(l.department))?.name||l.department||"Chưa cập nhật";return(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Thông tin cá nhân"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Tên hiển thị"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium flex-1 text-right",children:l.name||"Chưa cập nhật"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Giới tính"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium flex-1 text-right",children:l.gender||"Chưa cập nhật"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Ngày sinh"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium flex-1 text-right",children:l.birthday||"Chưa cập nhật"})]}),(0,t.jsxs)("div",{className:"py-2 border-b border-gray-100",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Điện thoại"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium flex-1 text-right",children:l.phone||"Chưa cập nhật"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-2 pl-32",children:"Số điện thoại chỉ hiển thị với người có lưu số bạn trong danh bạ máy"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Email"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium flex-1 text-right",children:l.email||"Chưa cập nhật"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Địa chỉ"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium flex-1 text-right",children:l.address||"Chưa cập nhật"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Phòng ban"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium flex-1 text-right",children:S})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-gray-500 w-32",children:"Chức vụ"}),(0,t.jsx)("span",{className:"text-gray-900 font-medium flex-1 text-right",children:l.title||"Chưa cập nhật"})]})]}),(0,t.jsxs)("button",{onClick:()=>m(!0),className:"w-full mt-6 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 rounded-full flex items-center justify-center gap-2 transition-colors cursor-pointer",children:[(0,t.jsx)(y.HiPencil,{className:"w-4 h-4"}),"Chỉnh sửa"]})]})}function S({tab:e,isOwner:a,overviewData:s,handleOverviewData:r,profileIdForQr:n}){return(0,t.jsxs)("div",{className:"",children:[(0,t.jsxs)("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500 delay-100",children:["info"===e&&(0,t.jsx)(t.Fragment,{children:a?(0,t.jsx)(C,{isOwner:a,onDataChange:e=>r(e)}):(0,t.jsx)(p,{data:s})}),"qr"===e&&(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Mã QR"}),(0,t.jsx)("div",{className:"flex justify-center py-6",children:(0,t.jsx)("div",{className:" p-2  ",children:(0,t.jsx)(d,{profilePath:n?`/profile/${encodeURIComponent(n)}`:""})})})]}),"settings"===e&&a&&(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Cài đặt"}),(0,t.jsx)(b,{})]}),"profile"===e&&(0,t.jsx)(p,{data:s})]}),!["info","qr","settings","profile"].includes(e)&&(0,t.jsx)("div",{className:"text-center py-20 text-gray-500",children:(0,t.jsx)("p",{className:"text-lg",children:"Chưa có nội dung"})})]})}var k=e.i(74080);function T({isOpen:e,onClose:s,title:r,children:n,rightAction:i,headerClassName:l="",titleClassName:o="",backButtonClassName:d=""}){let[c,x]=(0,a.useState)(!1),[h,m]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{x(!0)},[]),(0,a.useEffect)(()=>{if(e)m(!0),document.body.style.overflow="hidden";else{let e=setTimeout(()=>m(!1),300);return document.body.style.overflow="",()=>clearTimeout(e)}},[e]),c&&h)?(0,k.createPortal)((0,t.jsxs)("div",{className:"fixed inset-0 z-[9999] flex justify-center items-end md:items-center",children:[(0,t.jsx)("div",{className:`absolute inset-0 bg-black/20 backdrop-blur-sm transition-opacity duration-300 ${e?"opacity-100":"opacity-0"}`,onClick:s}),(0,t.jsxs)("div",{className:`relative w-full h-full md:h-[90vh] md:max-w-[480px] md:rounded-3xl md:overflow-hidden bg-white shadow-2xl transition-all duration-300 ease-in-out transform flex flex-col ${e?"translate-x-0 opacity-100 scale-100":"translate-x-full md:translate-x-0 md:opacity-0 md:scale-95"}`,children:[(0,t.jsxs)("div",{className:`flex-none p-2 border-b border-gray-100 flex items-center justify-between sticky top-0 z-10 ${l||"bg-white/80 backdrop-blur-md"}`,children:[(0,t.jsx)("button",{onClick:s,className:`p-2 -ml-2 rounded-full transition-colors cursor-pointer ${d||"text-gray-600 hover:bg-gray-100 active:bg-gray-200"}`,children:(0,t.jsx)(y.HiChevronLeft,{className:"w-6 h-6"})}),(0,t.jsx)("h2",{className:`text-lg font-bold flex-1 text-center pr-8 ${o||"text-gray-800"}`,children:r}),i&&(0,t.jsx)("div",{className:"absolute right-4",children:i})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto bg-gray-50 custom-scrollbar",children:n})]})]}),document.body):null}function H(){let e=(0,s.useParams)(),o=(0,s.useRouter)(),d="string"==typeof e?.user?e.user:"",{currentUser:c,currentId:x}=(0,n.useCurrentUser)(),h=!!(d&&(d===String(c?._id||"")||d===String(c?.username||""))),{viewingUserId:m,overviewData:g,setOverviewData:b,displayName:p,setDisplayName:f,displayDept:j,setDisplayDept:N,displayTitle:v,setDisplayTitle:w,displayBio:C,setDisplayBio:k,avatar:H,background:O,setAvatar:_,setBackground:P}=function(e,t,s){let[r,n]=(0,a.useState)(""),[i,l]=(0,a.useState)({phone:"",gender:"",birthday:"",email:"",address:"",department:"",title:"",bio:""}),[o,d]=(0,a.useState)(""),[c,x]=(0,a.useState)(""),[h,m]=(0,a.useState)(""),[g,u]=(0,a.useState)(""),[b,p]=(0,a.useState)(void 0),[y,f]=(0,a.useState)(void 0),j=(0,a.useCallback)(e=>{if(!e)return;n(String(e._id||""));let a=String(s?._id||""),r=e.nicknames||void 0,i=!t&&a&&r?String(r[a]||"").trim():"",o=String(e.name||e.username||"");d(i||o),x(String(e.department||"")),m(String(e.title||"")),u(String(e.bio||"")),p("string"==typeof e.avatar?e.avatar:void 0),f("string"==typeof e.background?e.background:void 0),l({phone:String(e.phone||""),gender:String(e.gender||""),birthday:String(e.birthday||""),email:String(e.email||""),address:String(e.address||""),department:String(e.department||""),title:String(e.title||""),bio:String(e.bio||"")})},[t,s]);return(0,a.useEffect)(()=>{if(t)return void j(s);let a=async()=>{try{let t=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"getById",_id:e})}),a=await t.json(),s=Array.isArray(a?.data)?a.data:void 0,r=a?.row||s?.[0]||a?.user||a;j(r||null)}catch{}};e&&a()},[t,e,s,j]),{viewingUserId:r,overviewData:i,displayName:o,setDisplayName:d,displayDept:c,setDisplayDept:x,displayTitle:h,setDisplayTitle:m,displayBio:g,setDisplayBio:u,avatar:b,background:y,setAvatar:p,setBackground:f,setOverviewData:l}}(d,!!h,c),M=m||h&&String(c?._id||"")||d,{handleUpload:$,isUploadingAvatar:E,isUploadingBackground:R}=function(e,t,s,r){let[n,i]=(0,a.useState)(!1),[l,o]=(0,a.useState)(!1);return{handleUpload:async(a,n)=>{if(t&&e&&a.type.startsWith("image/")&&!(a.size>0x40000000)){"avatar"===n?i(!0):o(!0);try{let t=new FormData;t.append("file",a),t.append("roomId",n),t.append("sender",e),t.append("receiver",""),t.append("type","image"),t.append("folderName","avatar"===n?"Avatars":"Backgrounds");let i=await fetch(`/api/upload?uploadId=${n}_${e}`,{method:"POST",body:t}),l=await i.json();if(!l.success||!l.link)return;let o=l.link,d=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"update",field:"_id",value:e,data:{[n]:o}})});if((await d.json()).error)return;"avatar"===n?s(o):r(o);try{let e=localStorage.getItem("info_user");if(e){let t=JSON.parse(e);localStorage.setItem("info_user",JSON.stringify({...t,[n]:o}))}}catch{}}finally{"avatar"===n?i(!1):o(!1)}}},isUploadingAvatar:n,isUploadingBackground:l}}(x,!!h,_,P),[I,J]=(0,a.useState)("profile"),[z,B]=(0,a.useState)(!1),[K,Q]=(0,a.useState)(""),[A,F]=(0,a.useState)(!1),L=(0,a.useRef)(null),U=(0,a.useRef)(null),[q,D]=(0,a.useState)(!1),[G,X]=(0,a.useState)(p),[V,W]=(0,a.useState)(!1),[Y,Z]=(0,a.useState)(!1),[ee,et]=(0,a.useState)(!1),[ea,es]=(0,a.useState)(null),[er,en]=(0,a.useState)(null),[ei,el]=(0,a.useState)("image.jpg"),eo=(e,t)=>{try{let a=new FileReader;a.onload=()=>{es(String(a.result||"")),en(t),el(e.name||("avatar"===t?"avatar.jpg":"background.jpg")),et(!0)},a.readAsDataURL(e)}catch{}},ed=async e=>{er&&(await $(e,er),et(!1),es(null),en(null))},ec=async e=>{if(!c||!c._id||!d)return;let t=String(e||"").trim();try{if(W(!0),!(await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"updateNickname",roomId:d,currentUserId:String(c._id),data:{nickname:t}})})).ok)throw Error();if(t)f(t);else try{let e=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"getById",_id:d})}),t=await e.json(),a=t?.row||t?.user||t,s=String(a?.name||a?.username||"");f(s)}catch{}D(!1)}finally{W(!1)}},ex=async(e,t)=>{if(x&&h)try{await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"update",field:"_id",value:x,data:{[e]:t}})});try{let a=localStorage.getItem("info_user");if(a){let s=JSON.parse(a);localStorage.setItem("info_user",JSON.stringify({...s,[e]:t}))}}catch{}"title"===e&&(w(t),b(e=>({...e,title:t}))),"bio"===e&&(k(t),b(e=>({...e,bio:t})))}catch(e){console.error("Failed to update profile",e)}},eh=(0,a.useMemo)(()=>{let e=String(j||g.department||"");return[{id:2,name:"Quản lý"},{id:3,name:"Kinh doanh"},{id:4,name:"Thiết kế"},{id:5,name:"Sản xuất"},{id:6,name:"Sàn TMĐT"},{id:7,name:"Kế toán"},{id:8,name:"Kho TM"},{id:9,name:"HCNS"},{id:10,name:"Maketing"}].find(t=>t.id===Number(e))?.name||e||"Chưa xác định"},[j,g.department]);return(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 ",children:[(0,t.jsxs)("div",{className:"w-full bg-gray-50 h-screen overflow-y-auto custom-scrollbar pb-[5rem] md:pb-0 relative no-scrollbar",children:[(0,t.jsxs)("div",{className:"relative bg-white pb-4 mb-2",children:[(0,t.jsxs)("div",{className:"absolute top-0 left-0 right-0 z-30 flex md:justify-end justify-end items-center p-4 text-white",children:[(0,t.jsx)("button",{onClick:()=>o.back(),className:"cursor-pointer hidden p-1.5 rounded-full bg-black/20 backdrop-blur-md hover:bg-black/30 transition-colors",children:(0,t.jsx)(y.HiChevronLeft,{className:"w-6 h-6"})}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{className:"cursor-pointer p-1.5 rounded-full bg-black/20 backdrop-blur-md hover:bg-black/30 transition-colors",children:(0,t.jsx)(y.HiClock,{className:"w-6 h-6"})}),h&&(0,t.jsx)("button",{onClick:()=>{J("more_actions"),B(!0)},className:"cursor-pointer p-1.5 rounded-full bg-black/20 backdrop-blur-md hover:bg-black/30 transition-colors",children:(0,t.jsx)(y.HiEllipsisHorizontal,{className:"w-6 h-6"})})]})]}),(0,t.jsxs)("div",{className:"relative h-64 w-full z-0",children:[O?(0,t.jsx)(r.default,{src:(0,i.getProxyUrl)(O),alt:"Cover",fill:!0,className:"object-cover",priority:!0,sizes:"100vw"}):(0,t.jsx)("div",{className:"absolute inset-0 bg-blue-400"}),R&&(0,t.jsx)("div",{className:"absolute inset-0 bg-black/40 z-20 flex items-center justify-center backdrop-blur-sm",children:(0,t.jsx)("div",{className:"w-10 h-10 border-4 border-white/30 border-t-white rounded-full animate-spin"})}),h&&!R&&(0,t.jsxs)("label",{className:"absolute bottom-4 right-4 p-2 bg-black/30 backdrop-blur-md rounded-full text-white cursor-pointer hover:bg-black/40 transition-colors z-10",children:[(0,t.jsx)(y.HiCamera,{className:"w-5 h-5"}),(0,t.jsx)("input",{ref:U,type:"file",accept:"image/*",className:"hidden",onChange:e=>e.target.files?.[0]&&eo(e.target.files[0],"background")})]})]}),(0,t.jsxs)("div",{className:"relative px-4 flex flex-col items-center -mt-16 pointer-events-none",children:[(0,t.jsxs)("div",{className:"relative pointer-events-auto",children:[(0,t.jsx)("div",{className:"absolute -top-12 left-1/2 -translate-x-1/2 whitespace-nowrap bg-white text-gray-700 text-xs font-medium px-3 py-1.5 rounded-2xl shadow-lg border border-gray-100 after:content-[''] after:absolute after:top-full after:left-1/2 after:-translate-x-1/2 after:border-4 after:border-transparent after:border-t-white animate-bounce",children:"Trạng thái hiện tại"}),(0,t.jsxs)("div",{className:"w-32 h-32 rounded-full border-4 border-white shadow-md overflow-hidden relative bg-gray-200 z-10",children:[H&&!Y?(0,t.jsx)(r.default,{src:(0,i.getProxyUrl)(H),alt:"Avatar",fill:!0,className:"object-cover",sizes:"(max-width: 768px) 100vw, 33vw",unoptimized:!0,onError:()=>Z(!0),onLoadingComplete:()=>Z(!1)}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-300 text-gray-500",children:(0,t.jsx)(y.HiUserCircle,{className:"w-20 h-20"})}),E&&(0,t.jsx)("div",{className:"absolute inset-0 bg-black/40 z-20 flex items-center justify-center backdrop-blur-sm",children:(0,t.jsx)("div",{className:"w-8 h-8 border-4 border-white/30 border-t-white rounded-full animate-spin"})}),h&&!E&&(0,t.jsxs)("label",{className:"absolute inset-0 bg-black/30 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity cursor-pointer z-10",children:[(0,t.jsx)(y.HiCamera,{className:"w-8 h-8 text-white"}),(0,t.jsx)("input",{ref:L,type:"file",accept:"image/*",className:"hidden",onChange:e=>e.target.files?.[0]&&eo(e.target.files[0],"avatar")})]})]})]}),q?(0,t.jsxs)("div",{className:"mt-3 flex items-center gap-2 pointer-events-auto",children:[(0,t.jsx)("input",{value:G,onChange:e=>X(e.target.value),className:"px-3 py-2 text-xl font-bold text-gray-900 border-b-2 border-blue-500 bg-transparent focus:outline-none",disabled:V,onKeyDown:e=>{"Enter"===e.key&&ec(G),"Escape"===e.key&&D(!1)}}),(0,t.jsx)("button",{onClick:()=>ec(G),disabled:V,className:`p-2 rounded-full ${V?"bg-green-100 text-green-500 opacity-70":"hover:bg-green-100 text-green-600"}`,title:"Lưu",children:V?(0,t.jsx)("span",{className:"w-5 h-5 inline-block border-2 border-green-600 border-t-transparent rounded-full animate-spin"}):(0,t.jsx)(y.HiCheck,{className:"w-5 h-5"})}),(0,t.jsx)("button",{onClick:()=>ec(""),disabled:V,className:"p-2 rounded-full hover:bg-gray-100 text-gray-600",title:"Xóa biệt danh",children:(0,t.jsx)(y.HiArchiveBox,{className:"w-5 h-5"})}),(0,t.jsx)("button",{onClick:()=>{D(!1),X(p)},disabled:V,className:"p-2 rounded-full hover:bg-red-100 text-red-500",title:"Hủy",children:(0,t.jsx)(u.HiX,{className:"w-5 h-5"})})]}):(0,t.jsxs)("div",{className:"mt-3 flex items-center gap-2 pointer-events-auto",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:p}),!h&&(0,t.jsx)("button",{onClick:()=>{X(p),D(!0)},className:"p-2 rounded-full hover:bg-gray-100 text-gray-500",title:"Sửa biệt danh",children:(0,t.jsx)(y.HiPencilSquare,{className:"w-5 h-5"})})]}),(0,t.jsxs)("button",{onClick:()=>{J("edit_intro"),Q(C||""),B(!0)},className:"cursor-pointer mt-1 flex items-center gap-1 text-blue-600 text-sm font-medium hover:underline pointer-events-auto",children:[(0,t.jsx)(y.HiPencilSquare,{className:"w-4 h-4"}),C||"Cập nhật giới thiệu bản thân"]}),(0,t.jsxs)("div",{className:"flex flex-wrap justify-center gap-2 mt-4 w-full pointer-events-auto",children:[(g.title||v)&&(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-medium text-gray-600 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 shadow-sm",children:[(0,t.jsx)(y.HiBriefcase,{className:"w-3.5 h-3.5 text-purple-500"}),g.title||v]}),(g.department||j)&&(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-medium text-gray-600 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 shadow-sm",children:[(0,t.jsx)(y.HiBuildingOffice2,{className:"w-3.5 h-3.5 text-orange-500"}),eh]}),g.gender&&(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-medium text-gray-600 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 shadow-sm",children:[(0,t.jsx)(y.HiUserCircle,{className:"w-3.5 h-3.5 text-indigo-500"}),g.gender]}),g.birthday&&(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-medium text-gray-600 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 shadow-sm",children:[(0,t.jsx)(y.HiCalendar,{className:"w-3.5 h-3.5 text-pink-500"}),g.birthday]}),g.phone&&(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-medium text-gray-600 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 shadow-sm",children:[(0,t.jsx)(y.HiPhone,{className:"w-3.5 h-3.5 text-green-500"}),g.phone]}),g.email&&(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-medium text-gray-600 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 shadow-sm",children:[(0,t.jsx)(y.HiEnvelope,{className:"w-3.5 h-3.5 text-blue-500"}),(0,t.jsx)("span",{className:"truncate max-w-[150px]",children:g.email})]}),g.address&&(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-medium text-gray-600 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 shadow-sm",children:[(0,t.jsx)(y.HiMapPin,{className:"w-3.5 h-3.5 text-red-500"}),(0,t.jsx)("span",{className:"truncate max-w-[150px]",children:g.address})]})]})]}),(0,t.jsxs)("div",{className:"mt-6 mx-4 flex justify-start md:justify-center gap-3 overflow-x-auto custom-scrollbar pb-2 ",children:[(0,t.jsxs)("button",{className:" cursor-pointer flex-shrink-0 flex items-center gap-2 px-4 py-2.5 bg-white border border-gray-200 rounded-xl shadow-sm active:scale-95 transition-transform",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center",children:(0,t.jsx)(y.HiSparkles,{className:"w-5 h-5"})}),(0,t.jsx)("span",{className:"font-medium text-gray-700 text-sm",children:"Cài zStyle"})]}),(0,t.jsxs)("button",{className:"cursor-pointer flex-shrink-0 flex items-center gap-2 px-4 py-2.5 bg-white border border-gray-200 rounded-xl shadow-sm active:scale-95 transition-transform",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center",children:(0,t.jsx)(y.HiPhoto,{className:"w-5 h-5"})}),(0,t.jsx)("span",{className:"font-medium text-gray-700 text-sm",children:"Ảnh của tôi"})]}),(0,t.jsxs)("button",{className:"cursor-pointer flex-shrink-0 flex items-center gap-2 px-4 py-2.5 bg-white border border-gray-200 rounded-xl shadow-sm active:scale-95 transition-transform",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center",children:(0,t.jsx)(y.HiArchiveBox,{className:"w-5 h-5"})}),(0,t.jsx)("span",{className:"font-medium text-gray-700 text-sm",children:"Kho khoảnh..."})]}),(0,t.jsxs)("button",{onClick:()=>{J("info"),B(!0)},className:"cursor-pointer flex-shrink-0 flex items-center gap-2 px-4 py-2.5 bg-white border border-gray-200 rounded-xl shadow-sm active:scale-95 transition-transform",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center",children:(0,t.jsx)(y.HiInformationCircle,{className:"w-5 h-5"})}),(0,t.jsx)("span",{className:"font-medium text-gray-700 text-sm",children:"Thông tin"})]}),(0,t.jsxs)("button",{onClick:()=>{J("qr"),B(!0)},className:"cursor-pointer flex-shrink-0 flex items-center gap-2 px-4 py-2.5 bg-white border border-gray-200 rounded-xl shadow-sm active:scale-95 transition-transform mr-4",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center",children:(0,t.jsx)(y.HiQrCode,{className:"w-5 h-5"})}),(0,t.jsx)("span",{className:"font-medium text-gray-700 text-sm",children:"Mã QR"})]})]})]}),(0,t.jsxs)("div",{className:"bg-white p-6 text-center",children:[(0,t.jsx)("div",{className:"relative w-full max-w-[200px] mx-auto mb-4",children:(0,t.jsxs)("div",{className:"w-24 h-40 mx-auto bg-blue-50 rounded-2xl border-2 border-blue-100 flex items-center justify-center relative shadow-inner",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-white rounded-full shadow-sm flex items-center justify-center",children:(0,t.jsx)(y.HiUserCircle,{className:"w-10 h-10 text-gray-300"})}),(0,t.jsx)("div",{className:"absolute -top-2 -right-4 bg-green-500 p-1.5 rounded-lg",children:(0,t.jsx)(y.HiEllipsisHorizontal,{className:"w-4 h-4 text-white"})}),(0,t.jsx)("div",{className:"absolute top-10 -left-4 text-red-500",children:(0,t.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-6 h-6",children:(0,t.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})})]})}),(0,t.jsxs)("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:["Hôm nay ",p," có gì vui?"]}),(0,t.jsx)("p",{className:"text-gray-500 text-sm mb-6 max-w-xs mx-auto leading-relaxed",children:"Đây là Nhật ký của bạn - Hãy làm đầy Nhật ký với những dấu ấn cuộc đời và kỷ niệm đáng nhớ nhé!"}),(0,t.jsx)("button",{className:"cursor-pointer bg-blue-600 text-white font-semibold px-8 py-3 rounded-full shadow-lg shadow-blue-200 active:scale-95 transition-transform hover:bg-blue-700",children:"Đăng lên Nhật ký"})]}),(0,t.jsx)(T,{isOpen:z,onClose:()=>B(!1),title:"profile"===I?"Hồ sơ":"qr"===I?"Mã QR":"info"===I?"Thông tin":"edit_intro"===I?"Chỉnh sửa lời giới thiệu":"more_actions"===I?p:"general_settings"===I?"Cài đặt":"privacy"===I?"Quyền riêng tư":"account"===I?"Quản lý tài khoản":"Cài đặt",headerClassName:"more_actions"===I?"bg-blue-500 text-white border-blue-500":void 0,titleClassName:"more_actions"===I?"text-white":void 0,backButtonClassName:"more_actions"===I?"text-white hover:bg-blue-600 active:bg-blue-700":void 0,rightAction:"edit_intro"===I?(0,t.jsx)("button",{onClick:()=>{ex("bio",K),B(!1)},className:"text-blue-600 font-bold text-base",children:"Lưu"}):"general_settings"===I?(0,t.jsx)("button",{className:"text-gray-800",children:(0,t.jsx)(y.HiOutlineMagnifyingGlass,{className:"w-6 h-6"})}):void 0,children:"edit_intro"===I?(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("textarea",{className:"w-full h-32 text-lg text-gray-800 placeholder-gray-400 focus:outline-none resize-none bg-transparent",placeholder:"Thêm lời giới thiệu của bạn",maxLength:100,value:K,onChange:e=>Q(e.target.value),autoFocus:!0}),(0,t.jsxs)("div",{className:"text-right text-gray-400 text-sm mt-2",children:[K.length,"/100"]}),(0,t.jsxs)("div",{className:"mt-6 flex items-center gap-3 cursor-pointer",onClick:()=>F(!A),children:[(0,t.jsx)("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors ${A?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:A&&(0,t.jsx)(y.HiCheck,{className:"text-white w-4 h-4"})}),(0,t.jsx)("span",{className:"text-gray-600 font-medium",children:"Chia sẻ lên nhật ký"})]})]}):"more_actions"===I?(0,t.jsxs)("div",{className:"bg-gray-50 min-h-[50vh] pb-8",children:[(0,t.jsxs)("div",{className:"bg-white",children:[(0,t.jsx)("button",{onClick:()=>J("info"),className:"cursor-pointer w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 border-b border-gray-100 active:bg-gray-100",children:"Thông tin"}),(0,t.jsx)("button",{onClick:()=>L.current?.click(),className:"cursor-pointer w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 border-b border-gray-100 active:bg-gray-100",children:"Đổi ảnh đại diện"}),(0,t.jsx)("button",{onClick:()=>U.current?.click(),className:"cursor-pointer w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 border-b border-gray-100 active:bg-gray-100",children:"Đổi ảnh bìa"}),(0,t.jsx)("button",{onClick:()=>{J("edit_intro"),Q(C||"")},className:"cursor-pointer w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 border-b border-gray-100 active:bg-gray-100",children:"Cập nhật giới thiệu bản thân"}),(0,t.jsx)("button",{onClick:()=>alert("Tính năng Ví của tôi đang được phát triển"),className:"w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 active:bg-gray-100",children:"Ví của tôi"})]}),(0,t.jsx)("div",{className:"h-2 bg-transparent"}),(0,t.jsxs)("div",{className:"bg-white",children:[(0,t.jsx)("div",{className:"px-4 py-3 text-blue-500 font-medium text-sm border-b border-gray-100",children:"Cài đặt"}),(0,t.jsx)("button",{onClick:()=>J("qr"),className:"cursor-pointer w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 border-b border-gray-100 active:bg-gray-100",children:"Mã QR của tôi"}),(0,t.jsx)("button",{onClick:()=>J("privacy"),className:"cursor-pointer w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 border-b border-gray-100 active:bg-gray-100",children:"Quyền riêng tư"}),(0,t.jsx)("button",{onClick:()=>J("settings"),className:"cursor-pointer w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 active:bg-gray-100",children:"Cài đặt chung"})]})]}):"privacy"===I?(0,t.jsx)("div",{className:"flex flex-col bg-gray-100 min-h-[80vh]",children:(0,t.jsxs)("div",{className:"bg-white mb-2 mt-2",children:[(0,t.jsxs)("button",{className:"w-full flex items-center justify-between px-4 py-3.5 hover:bg-gray-50 active:bg-gray-100 border-b border-gray-100 last:border-0",children:[(0,t.jsx)("span",{className:"text-base text-gray-800",children:"Nhật ký"}),(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"Công khai"})]}),(0,t.jsxs)("button",{className:"w-full flex items-center justify-between px-4 py-3.5 hover:bg-gray-50 active:bg-gray-100 border-b border-gray-100 last:border-0",children:[(0,t.jsx)("span",{className:"text-base text-gray-800",children:"Tin nhắn"}),(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"Mọi người"})]}),(0,t.jsxs)("button",{className:"w-full flex items-center justify-between px-4 py-3.5 hover:bg-gray-50 active:bg-gray-100 border-b border-gray-100 last:border-0",children:[(0,t.jsx)("span",{className:"text-base text-gray-800",children:"Sinh nhật"}),(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"Bạn bè"})]})]})}):"account"===I?(0,t.jsx)("div",{className:"flex flex-col bg-gray-100 min-h-[80vh]",children:(0,t.jsxs)("div",{className:"bg-white mb-2 mt-2",children:[(0,t.jsxs)("button",{className:"w-full flex items-center justify-between px-4 py-3.5 hover:bg-gray-50 active:bg-gray-100 border-b border-gray-100 last:border-0",children:[(0,t.jsx)("span",{className:"text-base text-gray-800",children:"Thông tin tài khoản"}),(0,t.jsx)(u.HiChevronRight,{className:"w-5 h-5 text-gray-400"})]}),(0,t.jsxs)("button",{className:"w-full flex items-center justify-between px-4 py-3.5 hover:bg-gray-50 active:bg-gray-100 border-b border-gray-100 last:border-0",children:[(0,t.jsx)("span",{className:"text-base text-gray-800",children:"Đổi mật khẩu"}),(0,t.jsx)(u.HiChevronRight,{className:"w-5 h-5 text-gray-400"})]}),(0,t.jsxs)("button",{className:"w-full flex items-center justify-between px-4 py-3.5 hover:bg-gray-50 active:bg-gray-100 border-b border-gray-100 last:border-0",children:[(0,t.jsx)("span",{className:"text-base text-red-500",children:"Xóa tài khoản"}),(0,t.jsx)(u.HiChevronRight,{className:"w-5 h-5 text-gray-400"})]})]})}):(0,t.jsx)(S,{tab:I,isOwner:!!h,overviewData:g,handleOverviewData:e=>{b(t=>({...t,...e})),void 0!==e.title&&w(String(e.title)),void 0!==e.bio&&k(String(e.bio)),void 0!==e.department&&N(String(e.department)),void 0!==e.name&&f(String(e.name))},profileIdForQr:M})})]}),(0,t.jsx)(l.default,{open:ee,src:ea,onClose:()=>et(!1),onConfirm:ed,aspectRatio:"background"===er?16/9:1,circle:"avatar"===er,fileName:ei,outputType:"image/jpeg",quality:.92})]})}e.s(["default",()=>H],87735)}]);