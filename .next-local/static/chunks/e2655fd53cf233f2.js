(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,74715,83872,52773,e=>{"use strict";e.s(["formatTimeAgo",0,e=>{if(!e)return"";let t=Math.floor((Date.now()-e)/1e3),r=Math.floor(t/60),n=Math.floor(r/60),a=Math.floor(n/24);if(t<60)return"Vá»«a xong";{if(r<60)return`${r} ph\xfat`;if(n<24)return`${n} giá»`;if(a<7)return`${a} ng\xe0y`;let t=new Date(e);return`${t.getDate().toString().padStart(2,"0")}/${(t.getMonth()+1).toString().padStart(2,"0")}`}}],74715);var t=e.i(43476);let r=({className:e,stroke:r})=>(0,t.jsx)("div",{children:(0,t.jsxs)("svg",{className:e,width:"800px",height:"800px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,t.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2.75C6.89137 2.75 2.75 6.89137 2.75 12C2.75 17.1086 6.89137 21.25 12 21.25C17.1086 21.25 21.25 17.1086 21.25 12C21.25 6.89137 17.1086 2.75 12 2.75ZM1.25 12C1.25 6.06294 6.06294 1.25 12 1.25C17.9371 1.25 22.75 6.06294 22.75 12C22.75 17.9371 17.9371 22.75 12 22.75C6.06294 22.75 1.25 17.9371 1.25 12ZM8.39747 15.5534C8.64413 15.2206 9.11385 15.1508 9.44661 15.3975C10.175 15.9373 11.0541 16.25 12 16.25C12.9459 16.25 13.825 15.9373 14.5534 15.3975C14.8862 15.1508 15.3559 15.2206 15.6025 15.5534C15.8492 15.8862 15.7794 16.3559 15.4466 16.6025C14.4742 17.3233 13.285 17.75 12 17.75C10.715 17.75 9.5258 17.3233 8.55339 16.6025C8.22062 16.3559 8.15082 15.8862 8.39747 15.5534Z",fill:r||"#1C274C"}),(0,t.jsx)("path",{d:"M16 10.5C16 11.3284 15.5523 12 15 12C14.4477 12 14 11.3284 14 10.5C14 9.67157 14.4477 9 15 9C15.5523 9 16 9.67157 16 10.5Z",fill:r||"#1C274C"}),(0,t.jsx)("path",{d:"M10 10.5C10 11.3284 9.55229 12 9 12C8.44772 12 8 11.3284 8 10.5C8 9.67157 8.44772 9 9 9C9.55229 9 10 9.67157 10 10.5Z",fill:r||"#1C274C"})]})});var n=e.i(71645);let a=["ðŸ‘","â¤ï¸","ðŸ˜‚","ðŸ˜®","ðŸ˜¢","ðŸ˜¡"];function s({isMine:e,onPick:s,visible:i,className:l=""}){let[o,c]=(0,n.useState)(!1);return(0,t.jsx)("div",{className:`
        absolute top-1/2 -translate-y-1/2 z-20 ${e?"right-full mr-3":"left-full ml-3"}
        ${i?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}
        transition-opacity duration-150
        ${l}
      `,children:(0,t.jsxs)("div",{className:"relative inline-flex",children:[(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),c(e=>!e)},className:"w-8 h-8 hover:cursor-pointer rounded-full bg-white border border-gray-300 shadow-sm flex items-center justify-center text-base hover:scale-110 active:scale-95 transition-all","aria-label":"Tháº£ cáº£m xÃºc",children:(0,t.jsx)(r,{className:"w-4 h-4"})}),(0,t.jsx)("div",{className:`absolute ${e?"left-1/2 -translate-x-1/2":"left-1/2 -translate-x-3/4"} z-50 bottom-full mb-2 flex items-center gap-1 px-3 py-2 bg-white rounded-full shadow-xl border border-gray-200 transition-all ${o?"opacity-100 visible pointer-events-auto scale-100":"opacity-0 invisible pointer-events-none scale-95"} origin-bottom whitespace-nowrap overflow-x-auto no-scrollbar max-w-[calc(100vw-64px)] sm:max-w-[20rem]`,children:a.map(e=>(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),c(!1),s(e)},className:"w-9 h-9 flex items-center justify-center text-xl rounded-full hover:bg-gray-100 active:scale-90 transition-transform","aria-label":e,children:e},e))})]})})}e.s(["default",()=>s],83872),e.s(["uploadFileWithProgress",0,(e,t,r)=>new Promise(n=>{let a=new XMLHttpRequest;a.upload.onprogress=e=>{e.lengthComputable&&r(e.loaded/e.total*100)},a.open("POST",e),a.onload=()=>{if(a.status>=200&&a.status<300)try{let e=JSON.parse(a.responseText);n(e)}catch{n({success:!1,message:"Pháº£n há»“i tá»« server khÃ´ng pháº£i JSON há»£p lá»‡"})}else try{let e=JSON.parse(a.responseText),t="string"==typeof e?.message&&e.message.trim()?e.message:a.statusText||`Upload tháº¥t báº¡i (${a.status})`;n({success:!1,message:t})}catch{n({success:!1,message:a.statusText||`Upload tháº¥t báº¡i (${a.status})`})}},a.onerror=()=>{n({success:!1,message:"Lá»—i máº¡ng (Network Error)"})},a.send(t)})],52773)},22724,e=>{"use strict";var t=e.i(71645);function r(){let e=(0,t.useMemo)(()=>{try{let e=localStorage.getItem("info_user");return e?JSON.parse(e):null}catch{return null}},[]),r=(0,t.useMemo)(()=>String(e?._id||e?.username||""),[e]);return{currentUser:e,currentId:r}}e.s(["useCurrentUser",()=>r])},98183,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={assign:function(){return o},searchParamsToUrlQuery:function(){return s},urlQueryToSearchParams:function(){return l}};for(var a in n)Object.defineProperty(r,a,{enumerable:!0,get:n[a]});function s(e){let t={};for(let[r,n]of e.entries()){let e=t[r];void 0===e?t[r]=n:Array.isArray(e)?e.push(n):t[r]=[e,n]}return t}function i(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function l(e){let t=new URLSearchParams;for(let[r,n]of Object.entries(e))if(Array.isArray(n))for(let e of n)t.append(r,i(e));else t.set(r,i(n));return t}function o(e,...t){for(let r of t){for(let t of r.keys())e.delete(t);for(let[t,n]of r.entries())e.append(t,n)}return e}},95057,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={formatUrl:function(){return l},formatWithValidation:function(){return c},urlObjectKeys:function(){return o}};for(var a in n)Object.defineProperty(r,a,{enumerable:!0,get:n[a]});let s=e.r(90809)._(e.r(98183)),i=/https?|ftp|gopher|file/;function l(e){let{auth:t,hostname:r}=e,n=e.protocol||"",a=e.pathname||"",l=e.hash||"",o=e.query||"",c=!1;t=t?encodeURIComponent(t).replace(/%3A/i,":")+"@":"",e.host?c=t+e.host:r&&(c=t+(~r.indexOf(":")?`[${r}]`:r),e.port&&(c+=":"+e.port)),o&&"object"==typeof o&&(o=String(s.urlQueryToSearchParams(o)));let d=e.search||o&&`?${o}`||"";return n&&!n.endsWith(":")&&(n+=":"),e.slashes||(!n||i.test(n))&&!1!==c?(c="//"+(c||""),a&&"/"!==a[0]&&(a="/"+a)):c||(c=""),l&&"#"!==l[0]&&(l="#"+l),d&&"?"!==d[0]&&(d="?"+d),a=a.replace(/[?#]/g,encodeURIComponent),d=d.replace("#","%23"),`${n}${c}${a}${d}${l}`}let o=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function c(e){return l(e)}},18967,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={DecodeError:function(){return g},MiddlewareNotFoundError:function(){return j},MissingStaticPage:function(){return b},NormalizeError:function(){return y},PageNotFoundError:function(){return v},SP:function(){return m},ST:function(){return x},WEB_VITALS:function(){return s},execOnce:function(){return i},getDisplayName:function(){return u},getLocationOrigin:function(){return c},getURL:function(){return d},isAbsoluteUrl:function(){return o},isResSent:function(){return p},loadGetInitialProps:function(){return h},normalizeRepeatedSlashes:function(){return f},stringifyError:function(){return N}};for(var a in n)Object.defineProperty(r,a,{enumerable:!0,get:n[a]});let s=["CLS","FCP","FID","INP","LCP","TTFB"];function i(e){let t,r=!1;return(...n)=>(r||(r=!0,t=e(...n)),t)}let l=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,o=e=>l.test(e);function c(){let{protocol:e,hostname:t,port:r}=window.location;return`${e}//${t}${r?":"+r:""}`}function d(){let{href:e}=window.location,t=c();return e.substring(t.length)}function u(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function p(e){return e.finished||e.headersSent}function f(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?`?${t.slice(1).join("?")}`:"")}async function h(e,t){let r=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await h(t.Component,t.ctx)}:{};let n=await e.getInitialProps(t);if(r&&p(r))return n;if(!n)throw Object.defineProperty(Error(`"${u(e)}.getInitialProps()" should resolve to an object. But found "${n}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return n}let m="undefined"!=typeof performance,x=m&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class g extends Error{}class y extends Error{}class v extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${e}`}}class b extends Error{constructor(e,t){super(),this.message=`Failed to load static file for page: ${e} ${t}`}}class j extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function N(e){return JSON.stringify({message:e.message,stack:e.stack})}},38982,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isLocalURL",{enumerable:!0,get:function(){return s}});let n=e.r(18967),a=e.r(52817);function s(e){if(!(0,n.isAbsoluteUrl)(e))return!0;try{let t=(0,n.getLocationOrigin)(),r=new URL(e,t);return r.origin===t&&(0,a.hasBasePath)(r.pathname)}catch(e){return!1}}},84508,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"errorOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},22016,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={default:function(){return g},useLinkStatus:function(){return v}};for(var a in n)Object.defineProperty(r,a,{enumerable:!0,get:n[a]});let s=e.r(90809),i=e.r(43476),l=s._(e.r(71645)),o=e.r(95057),c=e.r(8372),d=e.r(18581),u=e.r(18967),p=e.r(5550);e.r(33525);let f=e.r(91949),h=e.r(38982),m=e.r(9396);function x(e){return"string"==typeof e?e:(0,o.formatUrl)(e)}function g(t){var r;let n,a,s,[o,g]=(0,l.useOptimistic)(f.IDLE_LINK_STATUS),v=(0,l.useRef)(null),{href:b,as:j,children:N,prefetch:C=null,passHref:w,replace:S,shallow:T,scroll:P,onClick:O,onMouseEnter:_,onTouchStart:$,legacyBehavior:k=!1,onNavigate:E,ref:M,unstable_dynamicOnHover:I,...A}=t;n=N,k&&("string"==typeof n||"number"==typeof n)&&(n=(0,i.jsx)("a",{children:n}));let R=l.default.useContext(c.AppRouterContext),U=!1!==C,L=!1!==C?null===(r=C)||"auto"===r?m.FetchStrategy.PPR:m.FetchStrategy.Full:m.FetchStrategy.PPR,{href:F,as:D}=l.default.useMemo(()=>{let e=x(b);return{href:e,as:j?x(j):e}},[b,j]);if(k){if(n?.$$typeof===Symbol.for("react.lazy"))throw Object.defineProperty(Error("`<Link legacyBehavior>` received a direct child that is either a Server Component, or JSX that was loaded with React.lazy(). This is not supported. Either remove legacyBehavior, or make the direct child a Client Component that renders the Link's `<a>` tag."),"__NEXT_ERROR_CODE",{value:"E863",enumerable:!1,configurable:!0});a=l.default.Children.only(n)}let z=k?a&&"object"==typeof a&&a.ref:M,B=l.default.useCallback(e=>(null!==R&&(v.current=(0,f.mountLinkInstance)(e,F,R,L,U,g)),()=>{v.current&&((0,f.unmountLinkForCurrentNavigation)(v.current),v.current=null),(0,f.unmountPrefetchableInstance)(e)}),[U,F,R,L,g]),J={ref:(0,d.useMergedRef)(B,z),onClick(t){k||"function"!=typeof O||O(t),k&&a.props&&"function"==typeof a.props.onClick&&a.props.onClick(t),!R||t.defaultPrevented||function(t,r,n,a,s,i,o){if("undefined"!=typeof window){let c,{nodeName:d}=t.currentTarget;if("A"===d.toUpperCase()&&((c=t.currentTarget.getAttribute("target"))&&"_self"!==c||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.nativeEvent&&2===t.nativeEvent.which)||t.currentTarget.hasAttribute("download"))return;if(!(0,h.isLocalURL)(r)){s&&(t.preventDefault(),location.replace(r));return}if(t.preventDefault(),o){let e=!1;if(o({preventDefault:()=>{e=!0}}),e)return}let{dispatchNavigateAction:u}=e.r(99781);l.default.startTransition(()=>{u(n||r,s?"replace":"push",i??!0,a.current)})}}(t,F,D,v,S,P,E)},onMouseEnter(e){k||"function"!=typeof _||_(e),k&&a.props&&"function"==typeof a.props.onMouseEnter&&a.props.onMouseEnter(e),R&&U&&(0,f.onNavigationIntent)(e.currentTarget,!0===I)},onTouchStart:function(e){k||"function"!=typeof $||$(e),k&&a.props&&"function"==typeof a.props.onTouchStart&&a.props.onTouchStart(e),R&&U&&(0,f.onNavigationIntent)(e.currentTarget,!0===I)}};return(0,u.isAbsoluteUrl)(D)?J.href=D:k&&!w&&("a"!==a.type||"href"in a.props)||(J.href=(0,p.addBasePath)(D)),s=k?l.default.cloneElement(a,J):(0,i.jsx)("a",{...A,...J,children:n}),(0,i.jsx)(y.Provider,{value:o,children:s})}e.r(84508);let y=(0,l.createContext)(f.IDLE_LINK_STATUS),v=()=>(0,l.useContext)(y);("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},49392,e=>{"use strict";var t=e.i(43476),r=e.i(71645),n=e.i(57688),a=e.i(74715),s=e.i(14674);function i({images:e}){return e?.length?(0,t.jsx)("div",{className:"grid  gap-2",children:e.slice(0,4).map((e,r)=>(0,t.jsx)(n.default,{alt:`Image ${r}`,width:200,height:200,src:e,className:"w-full h-64 rounded-2xl object-cover",unoptimized:e.includes("mega.nz")},r))}):null}function l({videos:e}){return e?.length?(0,t.jsx)("div",{className:"grid  gap-2",children:e.slice(0,4).map((e,r)=>(0,t.jsx)("video",{src:e,controls:!0,className:"w-full h-64 rounded-2xl object-cover"},r))}):null}var o=e.i(22724),c=e.i(83872),d=e.i(52773);function u(e){return e.startsWith("https://mega.nz/")?`/api/mega-stream?url=${encodeURIComponent(e)}`:e}function p({post:e,onLike:p}){let f,h,m=(0,r.useMemo)(()=>(0,a.formatTimeAgo)(e.createdAt),[e.createdAt]),x=(0,r.useMemo)(()=>`${window.location.origin}/moments/${e.id}`,[e.id]),{currentUser:g,currentId:y}=(0,o.useCurrentUser)(),v=(0,r.useMemo)(()=>String(e.author.id)===String(y),[e.author.id,y]),[b,j]=(0,r.useState)(!1),[N,C]=(0,r.useState)(!1),[w,S]=(0,r.useState)(e.content||""),[T,P]=(0,r.useState)(null),[O,_]=(0,r.useState)(!1),[$,k]=(0,r.useState)([]),[E,M]=(0,r.useState)(!1),[I,A]=(0,r.useState)(""),[R,U]=(0,r.useState)(e.comments),[L,F]=(0,r.useState)(!1),[D,z]=(0,r.useState)("post"),[B,J]=(0,r.useState)(e.images||[]),[H,K]=(0,r.useState)(e.videos||[]),[W,X]=(0,r.useState)(e.files||[]),V=(0,r.useRef)(null),Z=(0,r.useRef)(null),[q,Q]=(0,r.useState)(!1),[G,Y]=(0,r.useState)(0),[ee,et]=(0,r.useState)("");(0,r.useEffect)(()=>{U(e.comments)},[e.comments]),(0,r.useEffect)(()=>{J(e.images||[]),K(e.videos||[]),X(e.files||[])},[e.images,e.videos,e.files]);let er=async()=>{M(!0);try{let t=await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"readComments",postId:e.id,limit:50}),cache:"no-store"}),r=await t.json(),n=(Array.isArray(r?.data)?r.data:[]).map(e=>({id:String(e._id??e.id??""),userId:String(e.userId||""),username:e.username?String(e.username):void 0,avatar:e.avatar?String(e.avatar):void 0,content:String(e.content||""),createdAt:Number(e.createdAt||Date.now()),parentId:e.parentId?String(e.parentId):void 0,reactions:e.reactions||{}}));k(n)}catch{}M(!1)},en=async()=>{try{navigator.share?await navigator.share({title:"Chia sáº» bÃ i viáº¿t",url:x}):navigator.clipboard&&(await navigator.clipboard.writeText(x),alert("ÄÃ£ sao chÃ©p liÃªn káº¿t bÃ i viáº¿t"))}catch{}},ea=async()=>{let e=!O;_(e),e&&0===$.length&&await er()},[es,ei]=(0,r.useState)(null),el=async()=>{let t=I.trim();if(t&&y)try{let r=await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"addComment",postId:e.id,data:{userId:y,username:g?.name,avatar:g?.avatar,content:t,parentId:es||void 0}})}),n=await r.json(),a=String(n?._id||""),s=Date.now(),i={id:a||`${e.id}-${s}`,userId:String(y),username:String(g?.name||""),avatar:g?.avatar?String(g.avatar):void 0,content:t,createdAt:s,parentId:es||void 0,reactions:{}};k(e=>[...e,i]),U(e=>e+1),A(""),ei(null)}catch{}},eo=async(e,t)=>{let r=$.find(t=>t.id===e);if(!r||!y)return;let n=(r.reactions?.[t]||[]).includes(y);try{await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"toggleCommentReaction",commentId:e,userId:y,emoji:t,like:!n})}),k(r=>r.map(r=>{if(r.id!==e)return r;let a=r.reactions?.[t]||[],s=new Set(a);return n?s.delete(y):s.add(y),{...r,reactions:{...r.reactions||{},[t]:Array.from(s)}}}))}catch{}},ec=async e=>{if(!e)return;let t=Array.from(e).slice(0,6),r=t.length||1,n=0;for(let e of(et("áº¢nh/video"),Q(!0),Y(0),t)){let t=`up_${Date.now()}_${Math.random().toString(36).slice(2)}`,a=new FormData;a.append("file",e),a.append("roomId","moments-feed"),a.append("sender","system"),a.append("type","file"),a.append("folderName","moments-feed");let s=await (0,d.uploadFileWithProgress)(`/api/upload?uploadId=${t}`,a,e=>{Y(Math.min(100,n+e/r))});if(s&&"success"in s&&s.success){let t=s.link;e.type.startsWith("image/")?J(e=>[...e,t]):e.type.startsWith("video/")&&K(e=>[...e,t])}Y(n=Math.min(100,n+100/r))}Q(!1)},ed=async e=>{if(!e)return;let t=Array.from(e).slice(0,6),r=t.length||1,n=0;for(let e of(et("Táº­p tin"),Q(!0),Y(0),t)){let t=`up_${Date.now()}_${Math.random().toString(36).slice(2)}`,a=new FormData;a.append("file",e),a.append("roomId","moments-feed"),a.append("sender","system"),a.append("type","file"),a.append("folderName","moments-feed");let s=await (0,d.uploadFileWithProgress)(`/api/upload?uploadId=${t}`,a,e=>{Y(Math.min(100,n+e/r))});if(s&&"success"in s&&s.success){let e=s.link;X(t=>[...t,e])}Y(n=Math.min(100,n+100/r))}Q(!1)},eu=async()=>{if(v&&e.id)try{await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"update",field:"_id",value:e.id,data:{images:B,videos:H,files:W}})}),F(!1)}catch{}},ep=async()=>{if(v&&e.id)try{await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"delete",postId:e.id})}),j(!0)}catch{}},ef=async()=>{let t=w.trim();if(!v||!t)return void C(!1);try{await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"update",field:"_id",value:e.id,data:{content:t}})}),P(t)}catch{}C(!1)};return(0,t.jsxs)("div",{className:"bg-white rounded-3xl border shadow-sm",children:[(0,t.jsxs)("div",{className:"p-4 flex gap-3 flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(n.default,{src:e.author.avatar?u(e.author.avatar):"",width:44,height:44,alt:"avatar",className:"rounded-full",unoptimized:!0}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("p",{className:"font-bold text-sm",children:e.author.name}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:m})]})]}),(0,t.jsx)("div",{className:"relative",children:v&&!b&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>F(e=>!e),className:"p-2 rounded-lg hover:bg-gray-100",children:(0,t.jsx)(s.HiEllipsisVertical,{})}),L&&(0,t.jsxs)("div",{className:"absolute right-0 top-8 bg-white border rounded-2xl shadow-xl w-64 z-10",children:[(0,t.jsxs)("div",{className:"flex border-b",children:[(0,t.jsx)("button",{onClick:()=>z("post"),className:`flex-1 py-2 text-sm ${"post"===D?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-600"}`,children:"BÃ i viáº¿t"}),(0,t.jsx)("button",{onClick:()=>z("media"),className:`flex-1 py-2 text-sm ${"media"===D?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-600"}`,children:"Media"})]}),"post"===D?(0,t.jsxs)("div",{className:"p-2",children:[(0,t.jsx)("button",{onClick:()=>{F(!1),v&&(S(T??e.content??""),C(!0))},className:"w-full text-left px-3 py-2 rounded-lg hover:bg-gray-100 text-sm",children:"Sá»­a ná»™i dung"}),(0,t.jsx)("button",{onClick:()=>{F(!1),ep()},className:"w-full text-left px-3 py-2 rounded-lg hover:bg-red-50 text-sm text-red-600",children:"XÃ³a bÃ i viáº¿t"})]}):(0,t.jsxs)("div",{className:"p-2 space-y-2 max-h-72 overflow-y-auto",children:[q&&(0,t.jsxs)("div",{className:"px-3 py-2 rounded-xl bg-indigo-50 border border-indigo-100",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-indigo-700",children:[(0,t.jsxs)("span",{children:["Äang táº£i lÃªn ",ee]}),(0,t.jsxs)("span",{children:[Math.round(G),"%"]})]}),(0,t.jsx)("div",{className:"mt-1 h-2 bg-gray-200 rounded-full",children:(0,t.jsx)("div",{className:"h-2 bg-indigo-600 rounded-full",style:{width:`${Math.round(G)}%`}})})]}),(0,t.jsx)("input",{ref:V,type:"file",multiple:!0,accept:"image/*,video/*",className:"hidden",onChange:e=>ec(e.target.files)}),(0,t.jsx)("input",{ref:Z,type:"file",multiple:!0,className:"hidden",onChange:e=>ed(e.target.files)}),B.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-xs text-gray-500 mb-1",children:["áº¢nh (",B.length,")"]}),B.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center justify-between px-3 py-1 rounded-lg hover:bg-gray-100",children:[(0,t.jsxs)("span",{className:"text-xs",children:["áº¢nh ",r+1]}),(0,t.jsx)("button",{onClick:()=>{J(e=>e.filter((e,t)=>t!==r))},className:"text-xs text-red-600",children:"XÃ³a"})]},r))]}),H.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-xs text-gray-500 mb-1",children:["Video (",H.length,")"]}),H.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center justify-between px-3 py-1 rounded-lg hover:bg-gray-100",children:[(0,t.jsxs)("span",{className:"text-xs",children:["Video ",r+1]}),(0,t.jsx)("button",{onClick:()=>{K(e=>e.filter((e,t)=>t!==r))},className:"text-xs text-red-600",children:"XÃ³a"})]},r))]}),W.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-xs text-gray-500 mb-1",children:["File (",W.length,")"]}),W.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center justify-between px-3 py-1 rounded-lg hover:bg-gray-100",children:[(0,t.jsxs)("span",{className:"text-xs",children:["File ",r+1]}),(0,t.jsx)("button",{onClick:()=>{X(e=>e.filter((e,t)=>t!==r))},className:"text-xs text-red-600",children:"XÃ³a"})]},r))]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 pt-1",children:[(0,t.jsx)("button",{disabled:q,onClick:()=>V.current?.click(),className:`px-3 py-1 rounded-lg text-sm ${q?"bg-gray-200 text-gray-400":"bg-gray-100"}`,children:"ThÃªm áº£nh/video"}),(0,t.jsx)("button",{disabled:q,onClick:()=>Z.current?.click(),className:`px-3 py-1 rounded-lg text-sm ${q?"bg-gray-200 text-gray-400":"bg-gray-100"}`,children:"ThÃªm file"})]}),(0,t.jsx)("div",{className:"pt-2",children:(0,t.jsx)("button",{onClick:eu,className:"w-full px-3 py-2 rounded-lg bg-indigo-600 text-white text-sm",children:"LÆ°u thay Ä‘á»•i media"})})]})]})]})})]}),N&&(0,t.jsxs)("div",{className:"px-4",children:[(0,t.jsx)("textarea",{value:w,onChange:e=>S(e.target.value),className:"w-full rounded-xl border p-2 text-sm",rows:3}),(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:ef,className:"px-3 py-1 rounded-xl bg-indigo-600 text-white text-sm",children:"LÆ°u"}),(0,t.jsx)("button",{onClick:()=>C(!1),className:"px-3 py-1 rounded-xl bg-gray-200 text-sm",children:"Huá»·"})]})]}),(0,t.jsxs)("div",{className:"flex-1",children:[!b&&(T??e.content)?(0,t.jsx)("p",{className:"mt-2 px-4 text-sm whitespace-pre-line",children:T??e.content}):null,B.length&&!b?(0,t.jsx)(i,{images:B}):null,H.length?(0,t.jsx)(l,{videos:H}):null,W.length?(0,t.jsx)("div",{className:"mt-2 space-y-2",children:W.map((e,r)=>(0,t.jsxs)("a",{href:u(e),className:"block bg-gray-100 px-3 py-2 rounded-xl text-sm",target:"_blank",children:["File ",r+1]},r))}):null]})]}),(0,t.jsxs)("div",{className:"px-4 pb-3 flex justify-between text-xs text-gray-500",children:[(0,t.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,t.jsx)(s.HiHandThumbUp,{className:"text-indigo-600"}),e.likes]}),(0,t.jsxs)("span",{children:[R," bÃ¬nh luáº­n"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2 px-2 pb-3",children:[(0,t.jsxs)("button",{onClick:()=>p(e.id),className:"bg-gray-100 py-2 rounded-2xl flex items-center justify-center gap-2",children:[(0,t.jsx)(s.HiHandThumbUp,{})," ThÃ­ch"]}),(0,t.jsxs)("button",{onClick:ea,className:"bg-gray-100 py-2 rounded-2xl flex items-center justify-center gap-2",children:[(0,t.jsx)(s.HiChatBubbleLeftRight,{})," BÃ¬nh luáº­n"]}),(0,t.jsxs)("a",{href:x,className:"bg-gray-100 py-2 rounded-2xl flex items-center justify-center gap-2",onClick:e=>{e.preventDefault(),en()},children:[(0,t.jsx)(s.HiArrowUpTray,{})," Chia sáº»"]})]}),O&&(0,t.jsxs)("div",{className:"px-4 pb-4",children:[(0,t.jsx)("div",{className:"space-y-3",children:E?(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"Äang táº£i bÃ¬nh luáº­n..."}):0===$.length?(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"ChÆ°a cÃ³ bÃ¬nh luáº­n"}):(f={},$.forEach(e=>{let t=e.parentId||"__root__";(f[t]||=[]).push(e)}),h=(e,r)=>(0,t.jsxs)("div",{className:`flex items-start gap-2 ${r>0?"pl-10":""}`,children:[(0,t.jsx)(n.default,{src:e.avatar?u(e.avatar):"",width:r>0?24:28,height:r>0?24:28,alt:"avatar",className:"rounded-full",unoptimized:!0}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("p",{className:"text-xs font-semibold",children:e.username||"NgÆ°á»i dÃ¹ng"}),(0,t.jsx)("span",{className:"text-[10px] text-gray-500",children:(0,a.formatTimeAgo)(e.createdAt)})]}),(0,t.jsx)("p",{className:"text-sm",children:e.content}),(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2 relative",children:[(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)(c.default,{isMine:String(e.userId)===String(y),visible:!0,className:"static translate-y-0 top-auto",onPick:t=>eo(e.id,t)})}),(0,t.jsx)("button",{onClick:()=>{let t;return ei(e.id),t=e.username?`@${e.username} `:"",void A(e=>e||t)},className:"text-xs text-indigo-600",children:"Tráº£ lá»i"})]}),e.reactions&&Object.keys(e.reactions).length>0&&(0,t.jsx)("div",{className:"mt-1 flex flex-wrap gap-1 text-xs",children:Object.entries(e.reactions).map(([e,r])=>(0,t.jsxs)("span",{className:"px-2 py-0.5 rounded-full bg-gray-100",children:[e," ",r.length]},e))}),(f[e.id]||[]).map(e=>h(e,r+1))]})]},e.id),(f.__root__||[]).map(e=>(0,t.jsx)("div",{className:"space-y-2",children:h(e,0)},e.id)))}),(0,t.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,t.jsx)("input",{value:I,onChange:e=>A(e.target.value),placeholder:y?"Viáº¿t bÃ¬nh luáº­n...":"ÄÄƒng nháº­p Ä‘á»ƒ bÃ¬nh luáº­n",className:"flex-1 px-3 py-2 rounded-xl border",disabled:!y}),(0,t.jsx)("button",{onClick:el,disabled:!y||!I.trim(),className:"px-3 py-2 rounded-xl bg-indigo-600 text-white",children:"Gá»­i"})]})]})]})}e.s(["default",()=>p],49392)}]);