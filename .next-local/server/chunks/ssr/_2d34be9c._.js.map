{"version":3,"sources":["../../../../src/utils/dateUtils.ts","../../../../src/components/svg/ICSmile.tsx","../../../../src/components/%28chatPopup%29/components/ReactionButton.tsx","../../../../src/utils/uploadHelper.ts","../../../../src/app/%28zalo%29/chat-iframe/page.tsx","../../../../src/app/%28zalo%29/chat-iframe/menu-widget.tsx"],"sourcesContent":["export const formatTimeAgo = (timestamp?: number | null): string => {\r\n  if (!timestamp) return '';\r\n\r\n  const now = Date.now();\r\n  const diff = now - timestamp;\r\n\r\n  // Quy ƒë·ªïi ra gi√¢y, ph√∫t, gi·ªù, ng√†y\r\n  const seconds = Math.floor(diff / 1000);\r\n  const minutes = Math.floor(seconds / 60);\r\n  const hours = Math.floor(minutes / 60);\r\n  const days = Math.floor(hours / 24);\r\n\r\n  if (seconds < 60) {\r\n    return 'V·ª´a xong';\r\n  } else if (minutes < 60) {\r\n    return `${minutes} ph√∫t`;\r\n  } else if (hours < 24) {\r\n    return `${hours} gi·ªù`;\r\n  } else if (days < 7) {\r\n    return `${days} ng√†y`;\r\n  } else {\r\n    // N·∫øu qu√° 7 ng√†y th√¨ hi·ªán ng√†y th√°ng (VD: 20/11)\r\n    const date = new Date(timestamp);\r\n    return `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}`;\r\n  }\r\n};\r\n","import React from 'react';\r\n\r\nconst ICSmile = ({ className, stroke }: { className?: string; stroke?: string }) => {\r\n  return (\r\n    <div>\r\n      <svg\r\n        className={className}\r\n        width=\"800px\"\r\n        height=\"800px\"\r\n        viewBox=\"0 0 24 24\"\r\n        fill=\"none\"\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n      >\r\n        <path\r\n          fillRule=\"evenodd\"\r\n          clipRule=\"evenodd\"\r\n          d=\"M12 2.75C6.89137 2.75 2.75 6.89137 2.75 12C2.75 17.1086 6.89137 21.25 12 21.25C17.1086 21.25 21.25 17.1086 21.25 12C21.25 6.89137 17.1086 2.75 12 2.75ZM1.25 12C1.25 6.06294 6.06294 1.25 12 1.25C17.9371 1.25 22.75 6.06294 22.75 12C22.75 17.9371 17.9371 22.75 12 22.75C6.06294 22.75 1.25 17.9371 1.25 12ZM8.39747 15.5534C8.64413 15.2206 9.11385 15.1508 9.44661 15.3975C10.175 15.9373 11.0541 16.25 12 16.25C12.9459 16.25 13.825 15.9373 14.5534 15.3975C14.8862 15.1508 15.3559 15.2206 15.6025 15.5534C15.8492 15.8862 15.7794 16.3559 15.4466 16.6025C14.4742 17.3233 13.285 17.75 12 17.75C10.715 17.75 9.5258 17.3233 8.55339 16.6025C8.22062 16.3559 8.15082 15.8862 8.39747 15.5534Z\"\r\n          fill={stroke || '#1C274C'}\r\n        />\r\n        <path\r\n          d=\"M16 10.5C16 11.3284 15.5523 12 15 12C14.4477 12 14 11.3284 14 10.5C14 9.67157 14.4477 9 15 9C15.5523 9 16 9.67157 16 10.5Z\"\r\n          fill={stroke || '#1C274C'}\r\n        />\r\n        <path\r\n          d=\"M10 10.5C10 11.3284 9.55229 12 9 12C8.44772 12 8 11.3284 8 10.5C8 9.67157 8.44772 9 9 9C9.55229 9 10 9.67157 10 10.5Z\"\r\n          fill={stroke || '#1C274C'}\r\n        />\r\n      </svg>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ICSmile;\r\n","import ICSmile from '@/components/svg/ICSmile';\r\nimport React, { useState } from 'react';\r\n\r\ntype Props = {\r\n  isMine: boolean;\r\n  onPick: (emoji: string) => void;\r\n  visible?: boolean;\r\n  className?: string;\r\n};\r\n\r\nconst EMOJIS = ['üëç', '‚ù§Ô∏è', 'üòÇ', 'üòÆ', 'üò¢', 'üò°'];\r\n\r\nexport default function ReactionButton({ isMine, onPick, visible, className = '' }: Props) {\r\n  const [open, setOpen] = useState(false);\r\n  const sideCls = isMine ? 'right-full mr-3' : 'left-full ml-3';\r\n  const pickerSideCls = isMine ? 'left-1/2 -translate-x-1/2' : 'left-1/2 -translate-x-3/4';\r\n  // const pickerSideCls = isMine ? 'right-0' : 'left-0 -translate-x-';\r\n\r\n  return (\r\n    <div\r\n      className={`\r\n        absolute top-1/2 -translate-y-1/2 z-20 ${sideCls}\r\n        ${visible ? 'opacity-100 pointer-events-auto' : 'opacity-0 pointer-events-none'}\r\n        transition-opacity duration-150\r\n        ${className}\r\n      `}\r\n    >\r\n      <div className=\"relative inline-flex\">\r\n        <button\r\n          onClick={(e) => {\r\n            e.stopPropagation();\r\n            setOpen((v) => !v);\r\n          }}\r\n          className=\"w-8 h-8 hover:cursor-pointer rounded-full bg-white border border-gray-300 shadow-sm flex items-center justify-center text-base hover:scale-110 active:scale-95 transition-all\"\r\n          aria-label=\"Th·∫£ c·∫£m x√∫c\"\r\n        >\r\n          <ICSmile className='w-4 h-4'/>\r\n        </button>\r\n        <div\r\n          className={`absolute ${pickerSideCls} z-50 bottom-full mb-2 flex items-center gap-1 px-3 py-2 bg-white rounded-full shadow-xl border border-gray-200 transition-all ${open ? 'opacity-100 visible pointer-events-auto scale-100' : 'opacity-0 invisible pointer-events-none scale-95'} origin-bottom whitespace-nowrap overflow-x-auto no-scrollbar max-w-[calc(100vw-64px)] sm:max-w-[20rem]`}\r\n        >\r\n          {EMOJIS.map((emoji) => (\r\n            <button\r\n              key={emoji}\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                setOpen(false);\r\n                onPick(emoji);\r\n              }}\r\n              className=\"w-9 h-9 flex items-center justify-center text-xl rounded-full hover:bg-gray-100 active:scale-90 transition-transform\"\r\n              aria-label={emoji}\r\n            >\r\n              {emoji}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","/**\r\n * Upload file s·ª≠ d·ª•ng XMLHttpRequest ƒë·ªÉ theo d√µi ti·∫øn tr√¨nh (Progress)\r\n * @param url ƒê∆∞·ªùng d·∫´n API (v√≠ d·ª•: /api/upload)\r\n * @param formData D·ªØ li·ªáu form ch·ª©a file\r\n * @param onProgress Callback nh·∫≠n % ho√†n th√†nh (0 -> 100)\r\n */\r\nimport type { MessageCreate } from '@/types/Message';\r\n\r\nexport interface UploadSuccessResponse {\r\n  success: true;\r\n  link: string;\r\n  data: MessageCreate;\r\n  _id?: string;\r\n  saved?: boolean;\r\n}\r\n\r\nexport interface UploadErrorResponse {\r\n  success: false;\r\n  message: string;\r\n}\r\n\r\nexport type UploadResponse = UploadSuccessResponse | UploadErrorResponse;\r\n\r\nexport const uploadFileWithProgress = (\r\n  url: string,\r\n  formData: FormData,\r\n  onProgress: (percent: number) => void,\r\n): Promise<UploadResponse> => {\r\n  return new Promise((resolve) => {\r\n    const xhr = new XMLHttpRequest();\r\n\r\n    // 1. L·∫Øng nghe s·ª± ki·ªán ti·∫øn tr√¨nh upload (quan tr·ªçng nh·∫•t)\r\n    xhr.upload.onprogress = (event) => {\r\n      if (event.lengthComputable) {\r\n        const percentComplete = (event.loaded / event.total) * 100;\r\n        onProgress(percentComplete); // G·ªçi callback ƒë·ªÉ c·∫≠p nh·∫≠t UI\r\n      }\r\n    };\r\n\r\n    // 2. M·ªü k·∫øt n·ªëi POST\r\n    xhr.open('POST', url);\r\n\r\n    // 3. X·ª≠ l√Ω khi ho√†n t·∫•t\r\n    xhr.onload = () => {\r\n      if (xhr.status >= 200 && xhr.status < 300) {\r\n        try {\r\n          // Parse k·∫øt qu·∫£ tr·∫£ v·ªÅ t·ª´ server (JSON)\r\n          const response = JSON.parse(xhr.responseText) as UploadResponse;\r\n          resolve(response);\r\n        } catch {\r\n          resolve({ success: false, message: 'Ph·∫£n h·ªìi t·ª´ server kh√¥ng ph·∫£i JSON h·ª£p l·ªá' });\r\n        }\r\n      } else {\r\n        try {\r\n          const parsed = JSON.parse(xhr.responseText) as { message?: string };\r\n          const msg =\r\n            typeof parsed?.message === 'string' && parsed.message.trim()\r\n              ? parsed.message\r\n              : xhr.statusText || `Upload th·∫•t b·∫°i (${xhr.status})`;\r\n          resolve({ success: false, message: msg });\r\n        } catch {\r\n          const msg = xhr.statusText || `Upload th·∫•t b·∫°i (${xhr.status})`;\r\n          resolve({ success: false, message: msg });\r\n        }\r\n      }\r\n    };\r\n\r\n    // 4. X·ª≠ l√Ω l·ªói m·∫°ng\r\n    xhr.onerror = () => {\r\n      resolve({ success: false, message: 'L·ªói m·∫°ng (Network Error)' });\r\n    };\r\n\r\n    // 5. G·ª≠i d·ªØ li·ªáu ƒëi\r\n    xhr.send(formData);\r\n  });\r\n};\r\n","'use client';\r\n\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport Sidebar from '@/components/base/Sidebar';\r\nimport { useHomePage } from '@/hooks/useHomePage';\r\nimport ChatWindow from '@/app/(zalo)/home/ChatPopup';\r\nimport MenuWidget from '@/app/(zalo)/chat-iframe/menu-widget';\r\nimport { io } from 'socket.io-client';\r\nimport { resolveSocketUrl } from '@/utils/utils';\r\nimport IncomingCallModal from '@/components/(call)/IncomingCallModal';\r\nimport { playGlobalRingTone, stopGlobalRingTone } from '@/utils/callRing';\r\n\r\nconst styleWidget = {\r\n  margin: 'p-0!',\r\n};\r\n\r\nexport default function ChatIframe() {\r\n  const {\r\n    currentUser,\r\n    isLoading,\r\n    allUsers,\r\n    groups,\r\n    searchTerm,\r\n    setSearchTerm,\r\n    setShowCreateGroupModal,\r\n    selectedChat,\r\n    handleSelectChat,\r\n    handleChatAction,\r\n    handleNavigateToMessage,\r\n    scrollToMessageId,\r\n    setScrollToMessageId,\r\n    setSelectedChat,\r\n  } = useHomePage();\r\n\r\n  const socketRef = useRef<ReturnType<typeof io> | null>(null);\r\n  const [incomingCallHome, setIncomingCallHome] = useState<{\r\n    from: string;\r\n    type: 'voice' | 'video';\r\n    roomId: string;\r\n    sdp: RTCSessionDescriptionInit;\r\n  } | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!currentUser) return;\r\n    const total = [...groups, ...allUsers].reduce((acc, c) => acc + (Number(c.unreadCount || 0) || 0), 0) || 0;\r\n    try {\r\n      window.parent?.postMessage({ type: 'HUPUNA_WIDGET_NOTIFY_COUNT', count: total }, window.location.origin);\r\n    } catch {}\r\n  }, [groups, allUsers, currentUser]);\r\n\r\n  useEffect(() => {\r\n    if (!currentUser || !currentUser._id) return;\r\n    const socket = (socketRef.current = io(resolveSocketUrl(), {\r\n      transports: ['websocket'],\r\n      withCredentials: false,\r\n    }));\r\n    socket.emit('join_user', { userId: String(currentUser._id) });\r\n\r\n    socket.off('call_offer');\r\n    socket.off('call_end');\r\n    socket.off('call_reject');\r\n    socket.off('call_answer');\r\n\r\n    const handleOffer = (data: {\r\n      roomId: string;\r\n      target: string;\r\n      from: string;\r\n      type: 'voice' | 'video';\r\n      sdp: RTCSessionDescriptionInit;\r\n    }) => {\r\n      if (String(data.target) !== String(currentUser._id)) return;\r\n      if (selectedChat) return;\r\n      if (incomingCallHome) return;\r\n      setIncomingCallHome({\r\n        from: String(data.from),\r\n        type: data.type,\r\n        roomId: String(data.roomId),\r\n        sdp: data.sdp,\r\n      });\r\n      playGlobalRingTone();\r\n      try {\r\n        window.parent?.postMessage({ type: 'HUPUNA_WIDGET_CALL', active: true }, window.location.origin);\r\n      } catch {}\r\n    };\r\n\r\n    const handleEnd = () => {\r\n      stopGlobalRingTone();\r\n      setIncomingCallHome(null);\r\n      try {\r\n        window.parent?.postMessage({ type: 'HUPUNA_WIDGET_CALL', active: false }, window.location.origin);\r\n      } catch {}\r\n    };\r\n    const handleReject = () => {\r\n      stopGlobalRingTone();\r\n      setIncomingCallHome(null);\r\n      try {\r\n        window.parent?.postMessage({ type: 'HUPUNA_WIDGET_CALL', active: false }, window.location.origin);\r\n      } catch {}\r\n    };\r\n    const handleAnswer = () => {\r\n      stopGlobalRingTone();\r\n      try {\r\n        window.parent?.postMessage({ type: 'HUPUNA_WIDGET_CALL', active: false }, window.location.origin);\r\n      } catch {}\r\n    };\r\n\r\n    socket.on('call_offer', handleOffer);\r\n    socket.on('call_end', handleEnd);\r\n    socket.on('call_reject', handleReject);\r\n    socket.on('call_answer', handleAnswer);\r\n\r\n    return () => {\r\n      socket.off('call_offer', handleOffer);\r\n      socket.off('call_end', handleEnd);\r\n      socket.off('call_reject', handleReject);\r\n      socket.off('call_answer', handleAnswer);\r\n    };\r\n  }, [currentUser, selectedChat, incomingCallHome]);\r\n\r\n  if (isLoading || !currentUser) {\r\n    return <div className=\"flex h-full items-center justify-center bg-white\">Loading...</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"w-full h-full flex flex-col bg-white\">\r\n      <MenuWidget title=\"Chat Hupuna\" />\r\n      <div className=\"flex-1 overflow-hidden\">\r\n        {!selectedChat ? (\r\n          <Sidebar\r\n            currentUser={currentUser}\r\n            groups={groups}\r\n            allUsers={allUsers}\r\n            searchTerm={searchTerm}\r\n            setSearchTerm={setSearchTerm}\r\n            setShowCreateGroupModal={setShowCreateGroupModal}\r\n            selectedChat={selectedChat}\r\n            onSelectChat={handleSelectChat}\r\n            onChatAction={handleChatAction}\r\n            onNavigateToMessage={handleNavigateToMessage}\r\n            styleWidget={styleWidget.margin}\r\n          />\r\n        ) : (\r\n          <ChatWindow\r\n            selectedChat={selectedChat}\r\n            currentUser={currentUser}\r\n            allUsers={allUsers}\r\n            onShowCreateGroup={() => setShowCreateGroupModal(true)}\r\n            onChatAction={handleChatAction}\r\n            scrollToMessageId={scrollToMessageId}\r\n            onScrollComplete={() => setScrollToMessageId(null)}\r\n            onBackFromChat={() => setSelectedChat(null)}\r\n            groups={groups}\r\n            socket={socketRef.current}\r\n          />\r\n        )}\r\n      </div>\r\n      {incomingCallHome && (\r\n        <div className=\"fixed inset-0 z-[200] bg-black/50 flex items-center justify-center\">\r\n          <div className=\"w-full h-full md:h-auto md:max-w-md md:rounded-xl md:p-4 p-0\">\r\n            {(() => {\r\n              const caller = allUsers.find((u) => String(u._id) === String(incomingCallHome.from));\r\n              const avatar = caller?.avatar;\r\n              const name = caller?.name || 'Cu·ªôc g·ªçi ƒë·∫øn';\r\n              return (\r\n                <IncomingCallModal\r\n                  avatar={avatar}\r\n                  name={name}\r\n                  callType={incomingCallHome.type}\r\n                  onAccept={() => {\r\n                    const group = groups.find((g) => String(g._id) === String(incomingCallHome.roomId));\r\n                    if (group) {\r\n                      setSelectedChat(group);\r\n                    } else {\r\n                      const c = allUsers.find((u) => String(u._id) === String(incomingCallHome.from));\r\n                      if (c) setSelectedChat(c as unknown as (typeof groups)[number]);\r\n                    }\r\n                    setIncomingCallHome(null);\r\n                    stopGlobalRingTone();\r\n                    try {\r\n                      window.parent?.postMessage({ type: 'HUPUNA_WIDGET_CALL', active: false }, window.location.origin);\r\n                    } catch {}\r\n                  }}\r\n                  onReject={() => {\r\n                    socketRef.current?.emit('call_reject', {\r\n                      roomId: incomingCallHome.roomId,\r\n                      targets: [String(incomingCallHome.from)],\r\n                    });\r\n                    setIncomingCallHome(null);\r\n                    stopGlobalRingTone();\r\n                    try {\r\n                      window.parent?.postMessage({ type: 'HUPUNA_WIDGET_CALL', active: false }, window.location.origin);\r\n                    } catch {}\r\n                  }}\r\n                />\r\n              );\r\n            })()}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","'use client';\r\n\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport { HiEllipsisVertical, HiArrowRightOnRectangle, HiXMark, HiChatBubbleLeftRight } from 'react-icons/hi2';\r\n\r\nconst MenuWidget: React.FC<{ title?: string }> = ({ title = 'Chat' }) => {\r\n  const [open, setOpen] = useState(false);\r\n  const dropdownRef = useRef<HTMLDivElement>(null);\r\n  const btnRef = useRef<HTMLButtonElement>(null);\r\n\r\n  useEffect(() => {\r\n    const handler = (e: MouseEvent) => {\r\n      const target = e.target as Node;\r\n      if (\r\n        open &&\r\n        dropdownRef.current &&\r\n        !dropdownRef.current.contains(target) &&\r\n        btnRef.current &&\r\n        !btnRef.current.contains(target)\r\n      ) {\r\n        setOpen(false);\r\n      }\r\n    };\r\n    document.addEventListener('mousedown', handler);\r\n    return () => document.removeEventListener('mousedown', handler);\r\n  }, [open]);\r\n\r\n  const goHome = () => {\r\n    try {\r\n      window.open('/home', '_blank', 'noopener,noreferrer');\r\n    } catch {\r\n      window.location.href = '/home';\r\n    }\r\n    setOpen(false);\r\n  };\r\n\r\n  const closeWidget = () => {\r\n    try {\r\n      window.parent?.postMessage('HUPUNA_WIDGET_CLOSE', window.location.origin);\r\n      window.parent?.postMessage({ type: 'HUPUNA_WIDGET_CLOSE' }, window.location.origin);\r\n    } catch {}\r\n    setOpen(false);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* Header v·ªõi gradient xanh d∆∞∆°ng c·ª±c ƒë·∫πp */}\r\n      <div className=\"h-14 flex items-center justify-between px-5 bg-gradient-to-br from-sky-500 via-blue-600 to-blue-700 text-white shadow-lg relative z-20 select-none\">\r\n        {/* Left: Menu + Title */}\r\n        <div className=\"flex items-center gap-4\">\r\n          <button\r\n            ref={btnRef}\r\n            onClick={() => setOpen(!open)}\r\n            className=\"p-2.5 rounded-xl hover:bg-white/20 backdrop-blur-sm transition-all duration-300 group\"\r\n            aria-label=\"M·ªü menu\"\r\n          >\r\n            <HiEllipsisVertical className=\"w-6 h-6 group-hover:rotate-90 transition-transform duration-400\" />\r\n          </button>\r\n\r\n          <h3 className=\"text-base font-bold flex items-center gap-2.5\">\r\n            <HiChatBubbleLeftRight className=\"w-6 h-6\" />\r\n            {title}\r\n          </h3>\r\n        </div>\r\n\r\n        {/* Right: Close button */}\r\n        <button\r\n          onClick={closeWidget}\r\n          className=\"p-2.5 rounded-xl hover:bg-white/20 backdrop-blur-sm transition-all duration-300 group\"\r\n          aria-label=\"ƒê√≥ng widget\"\r\n        >\r\n          <HiXMark className=\"w-6 h-6 group-hover:scale-110 group-hover:rotate-12 transition-all duration-300\" />\r\n        </button>\r\n\r\n        {/* Dropdown Menu - n·ªïi b·∫≠t tr√™n n·ªÅn gradient */}\r\n        <div\r\n          ref={dropdownRef}\r\n          className={`absolute top-full left-5 mt-3 w-72 bg-white dark:bg-gray-900 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 overflow-hidden transition-all duration-300 origin-top-left ${\r\n            open\r\n              ? 'opacity-100 scale-100 translate-y-0 visible'\r\n              : 'opacity-0 scale-95 -translate-y-3 invisible pointer-events-none'\r\n          }`}\r\n        >\r\n          <div className=\"bg-gradient-to-br from-sky-500 via-blue-600 to-blue-700 p-4 text-white\">\r\n            <p className=\"text-sm font-semibold\">Hupuna Chat Widget</p>\r\n            <p className=\"text-xs opacity-90 mt-1\">B·∫°n ƒëang d√πng phi√™n b·∫£n nh√∫ng</p>\r\n          </div>\r\n\r\n          <div className=\"p-3\">\r\n            <button\r\n              onClick={goHome}\r\n              className=\"w-full flex items-center gap-4 px-4 py-3.5 rounded-xl bg-gradient-to-r from-sky-500 to-blue-600 hover:from-sky-600 hover:to-blue-700 text-white font-medium shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-300 group\"\r\n            >\r\n              <HiArrowRightOnRectangle className=\"w-5 h-5 group-hover:translate-x-2 transition-transform\" />\r\n              <div className=\"text-left\">\r\n                <div>M·ªü chat ƒë·∫ßy ƒë·ªß</div>\r\n                <div className=\"text-xs opacity-90\">Chuy·ªÉn ƒë·∫øn trang ch√≠nh Hupuna</div>\r\n              </div>\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"px-5 pb-4 text-xs text-gray-500 dark:text-gray-400 text-center\">Powered by Hupuna</div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default MenuWidget;\r\n"],"names":[],"mappings":"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"}