{"version":3,"sources":["../../../../src/app/%28zalo%29/profile/%5Buser%5D/page.tsx","../../../../src/hooks/%28profile%29/useViewingUser.tsx","../../../../src/hooks/%28profile%29/useUploadImage.tsx","../../../../src/components/%28profile%29/PorfileQR.tsx","../../../../src/components/%28profile%29/profile-setting/PasswordChange.tsx","../../../../src/components/%28profile%29/profile-setting/PrivacySettings.tsx","../../../../src/components/%28profile%29/profile-setting/NotificationSettings.tsx","../../../../src/components/%28profile%29/ProfileSettings.tsx","../../../../src/components/%28profile%29/ProfileOverview.tsx","../../../../src/components/%28profile%29/InforRow.tsx","../../../../src/components/%28profile%29/ProfileInfoView.tsx","../../../../src/components/%28profile%29/ProfileInfoEdit.tsx","../../../../src/components/%28profile%29/ProfileInfo.tsx","../../../../src/components/%28profile%29/ProfileContent.tsx","../../../../src/components/%28profile%29/MobileProfileSheet.tsx"],"sourcesContent":["// components/(profile)/ProfileInfo.tsx\r\n'use client';\r\n\r\nimport { useState, useMemo, useRef } from 'react';\r\nimport { useParams, useRouter } from 'next/navigation';\r\nimport Image from 'next/image';\r\nimport { useViewingUser } from '@/hooks/(profile)/useViewingUser';\r\nimport { useUploadImage } from '@/hooks/(profile)/useUploadImage';\r\nimport { useCurrentUser } from '@/hooks/(profile)/useCurrentUser';\r\nimport { getProxyUrl } from '@/utils/utils';\r\nimport CropImageModal from '@/components/base/CropImageModal';\r\n\r\nimport ProfileContent from '@/components/(profile)/ProfileContent';\r\nimport MobileProfileSheet from '@/components/(profile)/MobileProfileSheet';\r\n\r\nimport {\r\n  HiUserCircle,\r\n  HiQrCode,\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  HiCog6Tooth,\r\n  HiInformationCircle,\r\n  HiPhone,\r\n  HiEnvelope,\r\n  HiCalendar,\r\n  HiMapPin,\r\n  HiChevronLeft,\r\n  HiEllipsisHorizontal,\r\n  HiClock,\r\n  HiPencilSquare,\r\n  HiCamera,\r\n  HiPhoto,\r\n  HiSparkles,\r\n  HiArchiveBox,\r\n  HiCheck,\r\n  HiBuildingOffice2,\r\n  HiBriefcase,\r\n  HiOutlineMagnifyingGlass,\r\n} from 'react-icons/hi2';\r\nimport { HiChevronRight, HiX } from 'react-icons/hi';\r\n\r\nexport default function ProfileByIdPage() {\r\n  const params = useParams();\r\n  const router = useRouter();\r\n  const viewingId = typeof params?.['user'] === 'string' ? params['user'] : '';\r\n\r\n  const { currentUser, currentId } = useCurrentUser();\r\n  const isOwner = Boolean(\r\n    viewingId &&\r\n      (viewingId === String(currentUser?.['_id'] || '') ||\r\n        viewingId === String((currentUser?.['username'] as string) || '')),\r\n  );\r\n\r\n  const {\r\n    viewingUserId,\r\n    overviewData,\r\n    setOverviewData,\r\n    displayName,\r\n    setDisplayName,\r\n    displayDept,\r\n    setDisplayDept,\r\n    displayTitle,\r\n    setDisplayTitle,\r\n    displayBio,\r\n    setDisplayBio,\r\n    avatar,\r\n    background,\r\n    setAvatar,\r\n    setBackground,\r\n  } = useViewingUser(viewingId, !!isOwner, currentUser);\r\n\r\n  const profileIdForQr = viewingUserId || (isOwner ? String(currentUser?._id || '') || viewingId : viewingId);\r\n\r\n  const { handleUpload, isUploadingAvatar, isUploadingBackground } = useUploadImage(\r\n    currentId,\r\n    !!isOwner,\r\n    setAvatar,\r\n    setBackground,\r\n  );\r\n\r\n  const [tabMobile, setTabMobile] = useState<\r\n    'profile' | 'qr' | 'info' | 'settings' | 'edit_intro' | 'more_actions' | 'general_settings' | 'privacy' | 'account'\r\n  >('profile');\r\n  const [isMobileSheetOpen, setIsMobileSheetOpen] = useState(false);\r\n  const [introText, setIntroText] = useState('');\r\n  const [shareToDiary, setShareToDiary] = useState(false);\r\n\r\n  const avatarInputRef = useRef<HTMLInputElement>(null);\r\n  const backgroundInputRef = useRef<HTMLInputElement>(null);\r\n  const [isEditingNickname, setIsEditingNickname] = useState(false);\r\n  const [editNickname, setEditNickname] = useState(displayName);\r\n  const [isSavingNickname, setIsSavingNickname] = useState(false);\r\n  const [avatarError, setAvatarError] = useState(false);\r\n\r\n  const [cropOpen, setCropOpen] = useState(false);\r\n  const [cropSrc, setCropSrc] = useState<string | null>(null);\r\n  const [cropKind, setCropKind] = useState<'avatar' | 'background' | null>(null);\r\n  const [cropFileName, setCropFileName] = useState<string>('image.jpg');\r\n\r\n  const openCropper = (file: File, kind: 'avatar' | 'background') => {\r\n    try {\r\n      const reader = new FileReader();\r\n      reader.onload = () => {\r\n        setCropSrc(String(reader.result || ''));\r\n        setCropKind(kind);\r\n        setCropFileName(file.name || (kind === 'avatar' ? 'avatar.jpg' : 'background.jpg'));\r\n        setCropOpen(true);\r\n      };\r\n      reader.readAsDataURL(file);\r\n    } catch {}\r\n  };\r\n\r\n  const handleConfirmCrop = async (file: File) => {\r\n    if (!cropKind) return;\r\n    await handleUpload(file, cropKind);\r\n    setCropOpen(false);\r\n    setCropSrc(null);\r\n    setCropKind(null);\r\n  };\r\n  const handleSaveNickname = async (value: string) => {\r\n    if (!currentUser || !currentUser['_id'] || !viewingId) return;\r\n    const v = String(value || '').trim();\r\n    try {\r\n      setIsSavingNickname(true);\r\n      const res = await fetch('/api/users', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          action: 'updateNickname',\r\n          roomId: viewingId,\r\n          currentUserId: String(currentUser['_id']),\r\n          data: { nickname: v },\r\n        }),\r\n      });\r\n      if (!res.ok) throw new Error();\r\n      if (v) {\r\n        setDisplayName(v);\r\n      } else {\r\n        try {\r\n          const r = await fetch('/api/users', {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ action: 'getById', _id: viewingId }),\r\n          });\r\n          const j = await r.json();\r\n          const u = j?.row || j?.user || j;\r\n          const base = String(u?.name || u?.username || '');\r\n          setDisplayName(base);\r\n        } catch {}\r\n      }\r\n      setIsEditingNickname(false);\r\n    } finally {\r\n      setIsSavingNickname(false);\r\n    }\r\n  };\r\n\r\n  const handleUpdateProfile = async (field: string, value: string) => {\r\n    if (!currentId || !isOwner) return;\r\n    try {\r\n      await fetch('/api/users', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          action: 'update',\r\n          field: '_id',\r\n          value: currentId,\r\n          data: { [field]: value },\r\n        }),\r\n      });\r\n\r\n      // Update local storage\r\n      try {\r\n        const raw = localStorage.getItem('info_user');\r\n        if (raw) {\r\n          const parsed = JSON.parse(raw);\r\n          localStorage.setItem('info_user', JSON.stringify({ ...parsed, [field]: value }));\r\n        }\r\n      } catch {}\r\n\r\n      // Update local state\r\n      if (field === 'title') {\r\n        setDisplayTitle(value);\r\n        setOverviewData((prev) => ({ ...prev, title: value }));\r\n      }\r\n      if (field === 'bio') {\r\n        setDisplayBio(value);\r\n        setOverviewData((prev) => ({ ...prev, bio: value }));\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to update profile', error);\r\n    }\r\n  };\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  const tabsMobile = isOwner ? ['profile', 'qr', 'info', 'settings'] : ['profile', 'qr'];\r\n\r\n  const departmentLabel = useMemo(() => {\r\n    const opts = [\r\n      { id: 2, name: 'Quản lý' },\r\n      { id: 3, name: 'Kinh doanh' },\r\n      { id: 4, name: 'Thiết kế' },\r\n      { id: 5, name: 'Sản xuất' },\r\n      { id: 6, name: 'Sàn TMĐT' },\r\n      { id: 7, name: 'Kế toán' },\r\n      { id: 8, name: 'Kho TM' },\r\n      { id: 9, name: 'HCNS' },\r\n      { id: 10, name: 'Maketing' },\r\n    ];\r\n    const val = String(displayDept || overviewData.department || '');\r\n    return opts.find((o) => o.id === Number(val))?.name || val || 'Chưa xác định';\r\n  }, [displayDept, overviewData.department]);\r\n\r\n  const handleProfileUpdate = (data: Record<string, unknown>) => {\r\n    setOverviewData((prev) => ({ ...prev, ...data }));\r\n    if (data.title !== undefined) setDisplayTitle(String(data.title));\r\n    if (data.bio !== undefined) setDisplayBio(String(data.bio));\r\n    if (data.department !== undefined) setDisplayDept(String(data.department));\r\n    if (data.name !== undefined) setDisplayName(String(data.name));\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 \">\r\n      {/* ==================== UNIFIED MOBILE-LIKE VIEW ==================== */}\r\n      <div className=\"w-full bg-gray-50 h-screen overflow-y-auto custom-scrollbar pb-[5rem] md:pb-0 relative no-scrollbar\">\r\n        {/* Top Header Section */}\r\n        <div className=\"relative bg-white pb-4 mb-2\">\r\n          {/* Header Actions */}\r\n          <div className=\"absolute top-0 left-0 right-0 z-30 flex md:justify-end justify-end items-center p-4 text-white\">\r\n            <button\r\n              onClick={() => router.back()}\r\n              className=\"cursor-pointer hidden p-1.5 rounded-full bg-black/20 backdrop-blur-md hover:bg-black/30 transition-colors\"\r\n            >\r\n              <HiChevronLeft className=\"w-6 h-6\" />\r\n            </button>\r\n            <div className=\"flex gap-3\">\r\n              <button className=\"cursor-pointer p-1.5 rounded-full bg-black/20 backdrop-blur-md hover:bg-black/30 transition-colors\">\r\n                <HiClock className=\"w-6 h-6\" />\r\n              </button>\r\n              {isOwner && (\r\n                <button\r\n                  onClick={() => {\r\n                    setTabMobile('more_actions');\r\n                    setIsMobileSheetOpen(true);\r\n                  }}\r\n                  className=\"cursor-pointer p-1.5 rounded-full bg-black/20 backdrop-blur-md hover:bg-black/30 transition-colors\"\r\n                >\r\n                  <HiEllipsisHorizontal className=\"w-6 h-6\" />\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Cover Image */}\r\n          <div className=\"relative h-64 w-full z-0\">\r\n            {background ? (\r\n              <Image src={getProxyUrl(background)} alt=\"Cover\" fill className=\"object-cover\" priority sizes=\"100vw\" />\r\n            ) : (\r\n              <div className=\"absolute inset-0 bg-blue-400\" />\r\n            )}\r\n\r\n            {/* Loading Overlay for Background */}\r\n            {isUploadingBackground && (\r\n              <div className=\"absolute inset-0 bg-black/40 z-20 flex items-center justify-center backdrop-blur-sm\">\r\n                <div className=\"w-10 h-10 border-4 border-white/30 border-t-white rounded-full animate-spin\"></div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Edit Cover Button (Owner only) */}\r\n            {isOwner && !isUploadingBackground && (\r\n              <label className=\"absolute bottom-4 right-4 p-2 bg-black/30 backdrop-blur-md rounded-full text-white cursor-pointer hover:bg-black/40 transition-colors z-10\">\r\n                <HiCamera className=\"w-5 h-5\" />\r\n                <input\r\n                  ref={backgroundInputRef}\r\n                  type=\"file\"\r\n                  accept=\"image/*\"\r\n                  className=\"hidden\"\r\n                  onChange={(e) => e.target.files?.[0] && openCropper(e.target.files[0], 'background')}\r\n                />\r\n              </label>\r\n            )}\r\n          </div>\r\n\r\n          {/* Avatar & Info */}\r\n          <div className=\"relative px-4 flex flex-col items-center -mt-16 pointer-events-none\">\r\n            <div className=\"relative pointer-events-auto\">\r\n              {/* Status Bubble */}\r\n              <div className=\"absolute -top-12 left-1/2 -translate-x-1/2 whitespace-nowrap bg-white text-gray-700 text-xs font-medium px-3 py-1.5 rounded-2xl shadow-lg border border-gray-100 after:content-[''] after:absolute after:top-full after:left-1/2 after:-translate-x-1/2 after:border-4 after:border-transparent after:border-t-white animate-bounce\">\r\n                Trạng thái hiện tại\r\n              </div>\r\n\r\n              {/* Avatar */}\r\n              <div className=\"w-32 h-32 rounded-full border-4 border-white shadow-md overflow-hidden relative bg-gray-200 z-10\">\r\n                {avatar && !avatarError ? (\r\n                  <Image\r\n                    src={getProxyUrl(avatar)}\r\n                    alt=\"Avatar\"\r\n                    fill\r\n                    className=\"object-cover\"\r\n                    sizes=\"(max-width: 768px) 100vw, 33vw\"\r\n                    unoptimized\r\n                    onError={() => setAvatarError(true)}\r\n                    onLoadingComplete={() => setAvatarError(false)}\r\n                  />\r\n                ) : (\r\n                  <div className=\"w-full h-full flex items-center justify-center bg-gray-300 text-gray-500\">\r\n                    <HiUserCircle className=\"w-20 h-20\" />\r\n                  </div>\r\n                )}\r\n\r\n                {/* Loading Overlay for Avatar */}\r\n                {isUploadingAvatar && (\r\n                  <div className=\"absolute inset-0 bg-black/40 z-20 flex items-center justify-center backdrop-blur-sm\">\r\n                    <div className=\"w-8 h-8 border-4 border-white/30 border-t-white rounded-full animate-spin\"></div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Edit Avatar (Owner) */}\r\n                {isOwner && !isUploadingAvatar && (\r\n                  <label className=\"absolute inset-0 bg-black/30 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity cursor-pointer z-10\">\r\n                    <HiCamera className=\"w-8 h-8 text-white\" />\r\n                    <input\r\n                      ref={avatarInputRef}\r\n                      type=\"file\"\r\n                      accept=\"image/*\"\r\n                      className=\"hidden\"\r\n                      onChange={(e) => e.target.files?.[0] && openCropper(e.target.files[0], 'avatar')}\r\n                    />\r\n                  </label>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Name */}\r\n            {isEditingNickname ? (\r\n              <div className=\"mt-3 flex items-center gap-2 pointer-events-auto\">\r\n                <input\r\n                  value={editNickname}\r\n                  onChange={(e) => setEditNickname(e.target.value)}\r\n                  className=\"px-3 py-2 text-xl font-bold text-gray-900 border-b-2 border-blue-500 bg-transparent focus:outline-none\"\r\n                  disabled={isSavingNickname}\r\n                  onKeyDown={(e) => {\r\n                    if (e.key === 'Enter') handleSaveNickname(editNickname);\r\n                    if (e.key === 'Escape') setIsEditingNickname(false);\r\n                  }}\r\n                />\r\n                <button\r\n                  onClick={() => handleSaveNickname(editNickname)}\r\n                  disabled={isSavingNickname}\r\n                  className={`p-2 rounded-full ${isSavingNickname ? 'bg-green-100 text-green-500 opacity-70' : 'hover:bg-green-100 text-green-600'}`}\r\n                  title=\"Lưu\"\r\n                >\r\n                  {isSavingNickname ? (\r\n                    <span className=\"w-5 h-5 inline-block border-2 border-green-600 border-t-transparent rounded-full animate-spin\" />\r\n                  ) : (\r\n                    <HiCheck className=\"w-5 h-5\" />\r\n                  )}\r\n                </button>\r\n                <button\r\n                  onClick={() => handleSaveNickname('')}\r\n                  disabled={isSavingNickname}\r\n                  className=\"p-2 rounded-full hover:bg-gray-100 text-gray-600\"\r\n                  title=\"Xóa biệt danh\"\r\n                >\r\n                  <HiArchiveBox className=\"w-5 h-5\" />\r\n                </button>\r\n                <button\r\n                  onClick={() => {\r\n                    setIsEditingNickname(false);\r\n                    setEditNickname(displayName);\r\n                  }}\r\n                  disabled={isSavingNickname}\r\n                  className=\"p-2 rounded-full hover:bg-red-100 text-red-500\"\r\n                  title=\"Hủy\"\r\n                >\r\n                  <HiX className=\"w-5 h-5\" />\r\n                </button>\r\n              </div>\r\n            ) : (\r\n              <div className=\"mt-3 flex items-center gap-2 pointer-events-auto\">\r\n                <h1 className=\"text-2xl font-bold text-gray-900\">{displayName}</h1>\r\n                {!isOwner && (\r\n                  <button\r\n                    onClick={() => {\r\n                      setEditNickname(displayName);\r\n                      setIsEditingNickname(true);\r\n                    }}\r\n                    className=\"p-2 rounded-full hover:bg-gray-100 text-gray-500\"\r\n                    title=\"Sửa biệt danh\"\r\n                  >\r\n                    <HiPencilSquare className=\"w-5 h-5\" />\r\n                  </button>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {/* Edit Intro Link */}\r\n            <button\r\n              onClick={() => {\r\n                setTabMobile('edit_intro');\r\n                setIntroText(displayBio || '');\r\n                setIsMobileSheetOpen(true);\r\n              }}\r\n              className=\"cursor-pointer mt-1 flex items-center gap-1 text-blue-600 text-sm font-medium hover:underline pointer-events-auto\"\r\n            >\r\n              <HiPencilSquare className=\"w-4 h-4\" />\r\n              {displayBio || 'Cập nhật giới thiệu bản thân'}\r\n            </button>\r\n            {/* Additional Info (Mobile) */}\r\n            <div className=\"flex flex-wrap justify-center gap-2 mt-4 w-full pointer-events-auto\">\r\n              {(overviewData.title || displayTitle) && (\r\n                <div className=\"flex items-center gap-1.5 text-xs font-medium text-gray-600 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 shadow-sm\">\r\n                  <HiBriefcase className=\"w-3.5 h-3.5 text-purple-500\" />\r\n                  {overviewData.title || displayTitle}\r\n                </div>\r\n              )}\r\n              {(overviewData.department || displayDept) && (\r\n                <div className=\"flex items-center gap-1.5 text-xs font-medium text-gray-600 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 shadow-sm\">\r\n                  <HiBuildingOffice2 className=\"w-3.5 h-3.5 text-orange-500\" />\r\n                  {departmentLabel}\r\n                </div>\r\n              )}\r\n              {overviewData.gender && (\r\n                <div className=\"flex items-center gap-1.5 text-xs font-medium text-gray-600 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 shadow-sm\">\r\n                  <HiUserCircle className=\"w-3.5 h-3.5 text-indigo-500\" />\r\n                  {overviewData.gender}\r\n                </div>\r\n              )}\r\n              {overviewData.birthday && (\r\n                <div className=\"flex items-center gap-1.5 text-xs font-medium text-gray-600 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 shadow-sm\">\r\n                  <HiCalendar className=\"w-3.5 h-3.5 text-pink-500\" />\r\n                  {overviewData.birthday}\r\n                </div>\r\n              )}\r\n              {overviewData.phone && (\r\n                <div className=\"flex items-center gap-1.5 text-xs font-medium text-gray-600 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 shadow-sm\">\r\n                  <HiPhone className=\"w-3.5 h-3.5 text-green-500\" />\r\n                  {overviewData.phone}\r\n                </div>\r\n              )}\r\n              {overviewData.email && (\r\n                <div className=\"flex items-center gap-1.5 text-xs font-medium text-gray-600 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 shadow-sm\">\r\n                  <HiEnvelope className=\"w-3.5 h-3.5 text-blue-500\" />\r\n                  <span className=\"truncate max-w-[150px]\">{overviewData.email}</span>\r\n                </div>\r\n              )}\r\n              {overviewData.address && (\r\n                <div className=\"flex items-center gap-1.5 text-xs font-medium text-gray-600 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100 shadow-sm\">\r\n                  <HiMapPin className=\"w-3.5 h-3.5 text-red-500\" />\r\n                  <span className=\"truncate max-w-[150px]\">{overviewData.address}</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Horizontal Actions */}\r\n          <div className=\"mt-6 mx-4 flex justify-start md:justify-center gap-3 overflow-x-auto custom-scrollbar pb-2 \">\r\n            {/* Cài zStyle (Placeholder for Settings/Style) */}\r\n            <button className=\" cursor-pointer flex-shrink-0 flex items-center gap-2 px-4 py-2.5 bg-white border border-gray-200 rounded-xl shadow-sm active:scale-95 transition-transform\">\r\n              <div className=\"w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center\">\r\n                <HiSparkles className=\"w-5 h-5\" />\r\n              </div>\r\n              <span className=\"font-medium text-gray-700 text-sm\">Cài zStyle</span>\r\n            </button>\r\n\r\n            {/* Ảnh của tôi */}\r\n            <button className=\"cursor-pointer flex-shrink-0 flex items-center gap-2 px-4 py-2.5 bg-white border border-gray-200 rounded-xl shadow-sm active:scale-95 transition-transform\">\r\n              <div className=\"w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center\">\r\n                <HiPhoto className=\"w-5 h-5\" />\r\n              </div>\r\n              <span className=\"font-medium text-gray-700 text-sm\">Ảnh của tôi</span>\r\n            </button>\r\n\r\n            {/* Kho khoảnh khắc */}\r\n            <button className=\"cursor-pointer flex-shrink-0 flex items-center gap-2 px-4 py-2.5 bg-white border border-gray-200 rounded-xl shadow-sm active:scale-95 transition-transform\">\r\n              <div className=\"w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center\">\r\n                <HiArchiveBox className=\"w-5 h-5\" />\r\n              </div>\r\n              <span className=\"font-medium text-gray-700 text-sm\">Kho khoảnh...</span>\r\n            </button>\r\n\r\n            {/* Info Button (Restoring old functionality) */}\r\n            <button\r\n              onClick={() => {\r\n                setTabMobile('info');\r\n                setIsMobileSheetOpen(true);\r\n              }}\r\n              className=\"cursor-pointer flex-shrink-0 flex items-center gap-2 px-4 py-2.5 bg-white border border-gray-200 rounded-xl shadow-sm active:scale-95 transition-transform\"\r\n            >\r\n              <div className=\"w-8 h-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center\">\r\n                <HiInformationCircle className=\"w-5 h-5\" />\r\n              </div>\r\n              <span className=\"font-medium text-gray-700 text-sm\">Thông tin</span>\r\n            </button>\r\n\r\n            {/* QR Button */}\r\n            <button\r\n              onClick={() => {\r\n                setTabMobile('qr');\r\n                setIsMobileSheetOpen(true);\r\n              }}\r\n              className=\"cursor-pointer flex-shrink-0 flex items-center gap-2 px-4 py-2.5 bg-white border border-gray-200 rounded-xl shadow-sm active:scale-95 transition-transform mr-4\"\r\n            >\r\n              <div className=\"w-8 h-8 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center\">\r\n                <HiQrCode className=\"w-5 h-5\" />\r\n              </div>\r\n              <span className=\"font-medium text-gray-700 text-sm\">Mã QR</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Diary Section */}\r\n        <div className=\"bg-white p-6 text-center\">\r\n          <div className=\"relative w-full max-w-[200px] mx-auto mb-4\">\r\n            {/* Illustration placeholder */}\r\n            <div className=\"w-24 h-40 mx-auto bg-blue-50 rounded-2xl border-2 border-blue-100 flex items-center justify-center relative shadow-inner\">\r\n              <div className=\"w-12 h-12 bg-white rounded-full shadow-sm flex items-center justify-center\">\r\n                <HiUserCircle className=\"w-10 h-10 text-gray-300\" />\r\n              </div>\r\n              {/* Chat bubble icon */}\r\n              <div className=\"absolute -top-2 -right-4 bg-green-500 p-1.5 rounded-lg\">\r\n                <HiEllipsisHorizontal className=\"w-4 h-4 text-white\" />\r\n              </div>\r\n              {/* Heart icon */}\r\n              <div className=\"absolute top-10 -left-4 text-red-500\">\r\n                <svg viewBox=\"0 0 24 24\" fill=\"currentColor\" className=\"w-6 h-6\">\r\n                  <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\" />\r\n                </svg>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <h3 className=\"text-lg font-bold text-gray-900 mb-2\">Hôm nay {displayName} có gì vui?</h3>\r\n          <p className=\"text-gray-500 text-sm mb-6 max-w-xs mx-auto leading-relaxed\">\r\n            Đây là Nhật ký của bạn - Hãy làm đầy Nhật ký với những dấu ấn cuộc đời và kỷ niệm đáng nhớ nhé!\r\n          </p>\r\n\r\n          <button className=\"cursor-pointer bg-blue-600 text-white font-semibold px-8 py-3 rounded-full shadow-lg shadow-blue-200 active:scale-95 transition-transform hover:bg-blue-700\">\r\n            Đăng lên Nhật ký\r\n          </button>\r\n        </div>\r\n        <MobileProfileSheet\r\n          isOpen={isMobileSheetOpen}\r\n          onClose={() => setIsMobileSheetOpen(false)}\r\n          title={\r\n            tabMobile === 'profile'\r\n              ? 'Hồ sơ'\r\n              : tabMobile === 'qr'\r\n                ? 'Mã QR'\r\n                : tabMobile === 'info'\r\n                  ? 'Thông tin'\r\n                  : tabMobile === 'edit_intro'\r\n                    ? 'Chỉnh sửa lời giới thiệu'\r\n                    : tabMobile === 'more_actions'\r\n                      ? displayName\r\n                      : tabMobile === 'general_settings'\r\n                        ? 'Cài đặt'\r\n                        : tabMobile === 'privacy'\r\n                          ? 'Quyền riêng tư'\r\n                          : tabMobile === 'account'\r\n                            ? 'Quản lý tài khoản'\r\n                            : 'Cài đặt'\r\n          }\r\n          headerClassName={tabMobile === 'more_actions' ? 'bg-blue-500 text-white border-blue-500' : undefined}\r\n          titleClassName={tabMobile === 'more_actions' ? 'text-white' : undefined}\r\n          backButtonClassName={\r\n            tabMobile === 'more_actions' ? 'text-white hover:bg-blue-600 active:bg-blue-700' : undefined\r\n          }\r\n          rightAction={\r\n            tabMobile === 'edit_intro' ? (\r\n              <button\r\n                onClick={() => {\r\n                  handleUpdateProfile('bio', introText);\r\n                  setIsMobileSheetOpen(false);\r\n                }}\r\n                className=\"text-blue-600 font-bold text-base\"\r\n              >\r\n                Lưu\r\n              </button>\r\n            ) : tabMobile === 'general_settings' ? (\r\n              <button className=\"text-gray-800\">\r\n                <HiOutlineMagnifyingGlass className=\"w-6 h-6\" />\r\n              </button>\r\n            ) : undefined\r\n          }\r\n        >\r\n          {tabMobile === 'edit_intro' ? (\r\n            <div className=\"p-4\">\r\n              <textarea\r\n                className=\"w-full h-32 text-lg text-gray-800 placeholder-gray-400 focus:outline-none resize-none bg-transparent\"\r\n                placeholder=\"Thêm lời giới thiệu của bạn\"\r\n                maxLength={100}\r\n                value={introText}\r\n                onChange={(e) => setIntroText(e.target.value)}\r\n                autoFocus\r\n              />\r\n              <div className=\"text-right text-gray-400 text-sm mt-2\">{introText.length}/100</div>\r\n              <div\r\n                className=\"mt-6 flex items-center gap-3 cursor-pointer\"\r\n                onClick={() => setShareToDiary(!shareToDiary)}\r\n              >\r\n                <div\r\n                  className={`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors ${\r\n                    shareToDiary ? 'border-blue-500 bg-blue-500' : 'border-gray-300'\r\n                  }`}\r\n                >\r\n                  {shareToDiary && <HiCheck className=\"text-white w-4 h-4\" />}\r\n                </div>\r\n                <span className=\"text-gray-600 font-medium\">Chia sẻ lên nhật ký</span>\r\n              </div>\r\n            </div>\r\n          ) : tabMobile === 'more_actions' ? (\r\n            <div className=\"bg-gray-50 min-h-[50vh] pb-8\">\r\n              {/* Group 1 */}\r\n              <div className=\"bg-white\">\r\n                <button\r\n                  onClick={() => setTabMobile('info')}\r\n                  className=\"cursor-pointer w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 border-b border-gray-100 active:bg-gray-100\"\r\n                >\r\n                  Thông tin\r\n                </button>\r\n                <button\r\n                  onClick={() => avatarInputRef.current?.click()}\r\n                  className=\"cursor-pointer w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 border-b border-gray-100 active:bg-gray-100\"\r\n                >\r\n                  Đổi ảnh đại diện\r\n                </button>\r\n                <button\r\n                  onClick={() => backgroundInputRef.current?.click()}\r\n                  className=\"cursor-pointer w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 border-b border-gray-100 active:bg-gray-100\"\r\n                >\r\n                  Đổi ảnh bìa\r\n                </button>\r\n                <button\r\n                  onClick={() => {\r\n                    setTabMobile('edit_intro');\r\n                    setIntroText(displayBio || '');\r\n                  }}\r\n                  className=\"cursor-pointer w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 border-b border-gray-100 active:bg-gray-100\"\r\n                >\r\n                  Cập nhật giới thiệu bản thân\r\n                </button>\r\n                <button\r\n                  onClick={() => alert('Tính năng Ví của tôi đang được phát triển')}\r\n                  className=\"w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 active:bg-gray-100\"\r\n                >\r\n                  Ví của tôi\r\n                </button>\r\n              </div>\r\n\r\n              {/* Spacer */}\r\n              <div className=\"h-2 bg-transparent\"></div>\r\n\r\n              {/* Group 2 */}\r\n              <div className=\"bg-white\">\r\n                <div className=\"px-4 py-3 text-blue-500 font-medium text-sm border-b border-gray-100\">Cài đặt</div>\r\n                <button\r\n                  onClick={() => setTabMobile('qr')}\r\n                  className=\"cursor-pointer w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 border-b border-gray-100 active:bg-gray-100\"\r\n                >\r\n                  Mã QR của tôi\r\n                </button>\r\n                <button\r\n                  onClick={() => setTabMobile('privacy')}\r\n                  className=\"cursor-pointer w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 border-b border-gray-100 active:bg-gray-100\"\r\n                >\r\n                  Quyền riêng tư\r\n                </button>\r\n                <button\r\n                  onClick={() => setTabMobile('settings')}\r\n                  className=\"cursor-pointer w-full text-left px-4 py-3.5 text-base text-gray-800 hover:bg-gray-50 active:bg-gray-100\"\r\n                >\r\n                  Cài đặt chung\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ) : tabMobile === 'privacy' ? (\r\n            <div className=\"flex flex-col bg-gray-100 min-h-[80vh]\">\r\n              <div className=\"bg-white mb-2 mt-2\">\r\n                <button className=\"w-full flex items-center justify-between px-4 py-3.5 hover:bg-gray-50 active:bg-gray-100 border-b border-gray-100 last:border-0\">\r\n                  <span className=\"text-base text-gray-800\">Nhật ký</span>\r\n                  <span className=\"text-gray-500 text-sm\">Công khai</span>\r\n                </button>\r\n                <button className=\"w-full flex items-center justify-between px-4 py-3.5 hover:bg-gray-50 active:bg-gray-100 border-b border-gray-100 last:border-0\">\r\n                  <span className=\"text-base text-gray-800\">Tin nhắn</span>\r\n                  <span className=\"text-gray-500 text-sm\">Mọi người</span>\r\n                </button>\r\n                <button className=\"w-full flex items-center justify-between px-4 py-3.5 hover:bg-gray-50 active:bg-gray-100 border-b border-gray-100 last:border-0\">\r\n                  <span className=\"text-base text-gray-800\">Sinh nhật</span>\r\n                  <span className=\"text-gray-500 text-sm\">Bạn bè</span>\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ) : tabMobile === 'account' ? (\r\n            <div className=\"flex flex-col bg-gray-100 min-h-[80vh]\">\r\n              <div className=\"bg-white mb-2 mt-2\">\r\n                <button className=\"w-full flex items-center justify-between px-4 py-3.5 hover:bg-gray-50 active:bg-gray-100 border-b border-gray-100 last:border-0\">\r\n                  <span className=\"text-base text-gray-800\">Thông tin tài khoản</span>\r\n                  <HiChevronRight className=\"w-5 h-5 text-gray-400\" />\r\n                </button>\r\n                <button className=\"w-full flex items-center justify-between px-4 py-3.5 hover:bg-gray-50 active:bg-gray-100 border-b border-gray-100 last:border-0\">\r\n                  <span className=\"text-base text-gray-800\">Đổi mật khẩu</span>\r\n                  <HiChevronRight className=\"w-5 h-5 text-gray-400\" />\r\n                </button>\r\n                <button className=\"w-full flex items-center justify-between px-4 py-3.5 hover:bg-gray-50 active:bg-gray-100 border-b border-gray-100 last:border-0\">\r\n                  <span className=\"text-base text-red-500\">Xóa tài khoản</span>\r\n                  <HiChevronRight className=\"w-5 h-5 text-gray-400\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <ProfileContent\r\n              tab={tabMobile}\r\n              isOwner={!!isOwner}\r\n              overviewData={overviewData}\r\n              handleOverviewData={handleProfileUpdate}\r\n              profileIdForQr={profileIdForQr}\r\n            />\r\n          )}\r\n        </MobileProfileSheet>\r\n      </div>\r\n      <CropImageModal\r\n        open={cropOpen}\r\n        src={cropSrc}\r\n        onClose={() => setCropOpen(false)}\r\n        onConfirm={handleConfirmCrop}\r\n        aspectRatio={cropKind === 'background' ? 16 / 9 : 1}\r\n        circle={cropKind === 'avatar'}\r\n        fileName={cropFileName}\r\n        outputType=\"image/jpeg\"\r\n        quality={0.92}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","'use client';\r\n\r\nimport { useEffect, useState, useCallback } from 'react';\r\n\r\nexport function useViewingUser(viewingId: string, isOwner: boolean, currentUser: Record<string, unknown> | null) {\r\n  const [viewingUserId, setViewingUserId] = useState('');\r\n  const [overviewData, setOverviewData] = useState({\r\n    phone: '',\r\n    gender: '',\r\n    birthday: '',\r\n    email: '',\r\n    address: '',\r\n    department: '',\r\n    title: '',\r\n    bio: '',\r\n  });\r\n\r\n  const [displayName, setDisplayName] = useState('');\r\n  const [displayDept, setDisplayDept] = useState('');\r\n  const [displayTitle, setDisplayTitle] = useState('');\r\n  const [displayBio, setDisplayBio] = useState('');\r\n  const [avatar, setAvatar] = useState<string | undefined>(undefined);\r\n  const [background, setBackground] = useState<string | undefined>(undefined);\r\n\r\n  const fillFrom = useCallback(\r\n    (u: Record<string, unknown> | null) => {\r\n      if (!u) return;\r\n      setViewingUserId(String(u['_id'] || ''));\r\n      const myId = String((currentUser as Record<string, unknown> | null)?.['_id'] || '');\r\n      const nickMap = (u['nicknames'] as Record<string, unknown> | undefined) || undefined;\r\n      const nick = !isOwner && myId && nickMap ? String((nickMap[myId] as unknown) || '').trim() : '';\r\n      const baseName = String(u['name'] || u['username'] || '');\r\n      setDisplayName(nick || baseName);\r\n      setDisplayDept(String(u['department'] || ''));\r\n      setDisplayTitle(String(u['title'] || ''));\r\n      setDisplayBio(String(u['bio'] || ''));\r\n      setAvatar(typeof u['avatar'] === 'string' ? (u['avatar'] as string) : undefined);\r\n      setBackground(typeof u['background'] === 'string' ? (u['background'] as string) : undefined);\r\n\r\n      setOverviewData({\r\n        phone: String(u['phone'] || ''),\r\n        gender: String(u['gender'] || ''),\r\n        birthday: String(u['birthday'] || ''),\r\n        email: String(u['email'] || ''),\r\n        address: String(u['address'] || ''),\r\n        department: String(u['department'] || ''),\r\n        title: String(u['title'] || ''),\r\n        bio: String(u['bio'] || ''),\r\n      });\r\n    },\r\n    [isOwner, currentUser],\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (isOwner) {\r\n      fillFrom(currentUser);\r\n      return;\r\n    }\r\n\r\n    const fetchViewingUser = async () => {\r\n      try {\r\n        const res = await fetch('/api/users', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ action: 'getById', _id: viewingId }),\r\n        });\r\n\r\n        const json = await res.json();\r\n        const dataArr = Array.isArray(json?.data) ? (json.data as Record<string, unknown>[]) : undefined;\r\n\r\n        const userRow = json?.row || dataArr?.[0] || json?.user || json;\r\n\r\n        fillFrom(userRow || null);\r\n      } catch {}\r\n    };\r\n\r\n    if (viewingId) void fetchViewingUser();\r\n  }, [isOwner, viewingId, currentUser, fillFrom]);\r\n\r\n  return {\r\n    viewingUserId,\r\n    overviewData,\r\n    displayName,\r\n    setDisplayName,\r\n    displayDept,\r\n    setDisplayDept,\r\n    displayTitle,\r\n    setDisplayTitle,\r\n    displayBio,\r\n    setDisplayBio,\r\n    avatar,\r\n    background,\r\n    setAvatar,\r\n    setBackground,\r\n    setOverviewData,\r\n  };\r\n}\r\n","'use client';\r\n\r\nimport { useState } from 'react';\r\n\r\nexport function useUploadImage(\r\n  currentId: string,\r\n  isOwner: boolean,\r\n  setAvatar: (url: string) => void,\r\n  setBackground: (url: string) => void,\r\n) {\r\n  const [isUploadingAvatar, setIsUploadingAvatar] = useState(false);\r\n  const [isUploadingBackground, setIsUploadingBackground] = useState(false);\r\n\r\n  const handleUpload = async (file: File, kind: 'avatar' | 'background') => {\r\n    if (!isOwner || !currentId) return;\r\n    if (!file.type.startsWith('image/')) return;\r\n\r\n    // Tăng giới hạn lên 1GB hoặc bỏ qua check\r\n    const MAX = 1024 * 1024 * 1024; // 1GB\r\n    if (file.size > MAX) return;\r\n\r\n    if (kind === 'avatar') setIsUploadingAvatar(true);\r\n    else setIsUploadingBackground(true);\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('file', file);\r\n      formData.append('roomId', kind);\r\n      formData.append('sender', currentId);\r\n      formData.append('receiver', '');\r\n      formData.append('type', 'image');\r\n      formData.append('folderName', kind === 'avatar' ? 'Avatars' : 'Backgrounds');\r\n\r\n      const uploadRes = await fetch(`/api/upload?uploadId=${kind}_${currentId}`, {\r\n        method: 'POST',\r\n        body: formData,\r\n      });\r\n\r\n      const uploadJson = await uploadRes.json();\r\n      if (!uploadJson.success || !uploadJson.link) return;\r\n\r\n      const newUrl = uploadJson.link as string;\r\n\r\n      const updateRes = await fetch('/api/users', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          action: 'update',\r\n          field: '_id',\r\n          value: currentId,\r\n          data: { [kind]: newUrl },\r\n        }),\r\n      });\r\n\r\n      const json = await updateRes.json();\r\n      if (json.error) return;\r\n\r\n      if (kind === 'avatar') setAvatar(newUrl);\r\n      else setBackground(newUrl);\r\n\r\n      // update localStorage\r\n      try {\r\n        const raw = localStorage.getItem('info_user');\r\n        if (raw) {\r\n          const parsed = JSON.parse(raw);\r\n          localStorage.setItem('info_user', JSON.stringify({ ...parsed, [kind]: newUrl }));\r\n        }\r\n      } catch {}\r\n    } finally {\r\n      if (kind === 'avatar') setIsUploadingAvatar(false);\r\n      else setIsUploadingBackground(false);\r\n    }\r\n  };\r\n\r\n  return {\r\n    handleUpload,\r\n    isUploadingAvatar,\r\n    isUploadingBackground,\r\n  };\r\n}\r\n","'use client';\n\nimport { useEffect, useMemo, useState } from 'react';\nimport QRCode from 'qrcode';\nimport Image from 'next/image';\n\nfunction ProfileQR({ profilePath }: { profilePath: string }) {\n  const [dataUrl, setDataUrl] = useState<string>('');\n\n  const qrValue = useMemo(() => {\n    if (!profilePath) return '';\n    if (typeof window === 'undefined') return '';\n    const origin = window.location.origin;\n    const path = profilePath.startsWith('/') ? profilePath : `/${profilePath}`;\n    return `${origin}${path}`;\n  }, [profilePath]);\n\n  useEffect(() => {\n    let cancelled = false;\n    if (!qrValue) {\n      setDataUrl('');\n      return;\n    }\n    QRCode.toDataURL(qrValue, { errorCorrectionLevel: 'M', margin: 1, width: 320 })\n      .then((url: string) => {\n        if (!cancelled) setDataUrl(url);\n      })\n      .catch(() => {\n        if (!cancelled) setDataUrl('');\n      });\n    return () => {\n      cancelled = true;\n    };\n  }, [qrValue]);\n\n  return (\n    <div className=\"flex flex-col items-center space-y-3\">\n      <div className=\"w-40 h-40 bg-white rounded-lg flex items-center justify-center border border-gray-200\">\n        {dataUrl ? (\n          <Image width={320} height={320} src={dataUrl} alt=\"Mã QR hồ sơ\" className=\"w-full h-full rounded-lg\" />\n        ) : (\n          <span className=\"text-gray-400 text-sm\">Đang tạo QR…</span>\n        )}\n      </div>\n      <p className=\"text-sm text-gray-500 text-center md:text-base\">\n        Mã QR để người khác kết bạn hoặc xem hồ sơ của bạn.\n      </p>\n    </div>\n  );\n}\nexport default ProfileQR;\n","\"use client\";\r\n\r\nimport React, { useState } from \"react\";\r\nimport { useToast } from \"@/components/base/toast\";\r\n\r\nexport default function PasswordChange() {\r\n  const toast = useToast();\r\n  const [currentPassword, setCurrentPassword] = useState(\"\");\r\n  const [newPassword, setNewPassword] = useState(\"\");\r\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const handleSubmit = async () => {\r\n    if (!newPassword || newPassword !== confirmPassword) {\r\n      toast({ type: \"error\", message: \"Mật khẩu xác nhận không khớp\" });\r\n      return;\r\n    }\r\n    try {\r\n      setLoading(true);\r\n      const raw = typeof window !== \"undefined\" ? localStorage.getItem(\"info_user\") : null;\r\n      const u = raw ? JSON.parse(raw) : null;\r\n      const userId = String(u?.[\"_id\"] || \"\");\r\n      const res = await fetch(\"/api/users\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ action: \"changePassword\", data: { userId, currentPassword, newPassword } }),\r\n      });\r\n      const json = await res.json();\r\n      if (!res.ok || !json.success) {\r\n        toast({ type: \"error\", message: json.message || \"Đổi mật khẩu thất bại\" });\r\n        return;\r\n      }\r\n      toast({ type: \"success\", message: \"Đổi mật khẩu thành công\" });\r\n      setCurrentPassword(\"\");\r\n      setNewPassword(\"\");\r\n      setConfirmPassword(\"\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <input\r\n        type=\"password\"\r\n        placeholder=\"Mật khẩu hiện tại\"\r\n        value={currentPassword}\r\n        onChange={(e) => setCurrentPassword(e.target.value)}\r\n        className=\"w-full px-4 py-3 bg-white border border-gray-200 rounded-xl text-gray-800\"\r\n      />\r\n      <input\r\n        type=\"password\"\r\n        placeholder=\"Mật khẩu mới\"\r\n        value={newPassword}\r\n        onChange={(e) => setNewPassword(e.target.value)}\r\n        className=\"w-full px-4 py-3 bg-white border border-gray-200 rounded-xl text-gray-800\"\r\n      />\r\n      <input\r\n        type=\"password\"\r\n        placeholder=\"Xác nhận mật khẩu mới\"\r\n        value={confirmPassword}\r\n        onChange={(e) => setConfirmPassword(e.target.value)}\r\n        className=\"w-full px-4 py-3 bg-white border border-gray-200 rounded-xl text-gray-800\"\r\n      />\r\n      <button\r\n        onClick={handleSubmit}\r\n        disabled={loading}\r\n        className=\"cursor-pointer w-full px-4 py-3 rounded-xl bg-indigo-600 text-white font-semibold hover:bg-indigo-700 disabled:opacity-70\"\r\n      >\r\n        {loading ? \"Đang đổi...\" : \"Đổi mật khẩu\"}\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\n","\"use client\";\r\n\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useToast } from \"@/components/base/toast\";\r\n\r\ninterface PrivacyState {\r\n  showOnline: boolean;\r\n  allowFriendRequests: boolean;\r\n  allowTagging: boolean;\r\n}\r\n\r\nexport default function PrivacySettings() {\r\n  const toast = useToast();\r\n  const [state, setState] = useState<PrivacyState>({ showOnline: true, allowFriendRequests: true, allowTagging: true });\r\n  const [loadingKey, setLoadingKey] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    try {\r\n      const raw = typeof window !== \"undefined\" ? localStorage.getItem(\"info_user\") : null;\r\n      const u = raw ? JSON.parse(raw) : null;\r\n      const prev = (u?.[\"privacy\"] as PrivacyState) || null;\r\n      if (prev) setState(prev);\r\n    } catch {}\r\n  }, []);\r\n\r\n  const update = async (next: PrivacyState, key: keyof PrivacyState) => {\r\n    try {\r\n      setLoadingKey(String(key));\r\n      const raw = typeof window !== \"undefined\" ? localStorage.getItem(\"info_user\") : null;\r\n      const u = raw ? JSON.parse(raw) : null;\r\n      const userId = String(u?.[\"_id\"] || \"\");\r\n      const res = await fetch(\"/api/users\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ action: \"update\", field: \"_id\", value: userId, data: { privacy: next } }),\r\n      });\r\n      const json = await res.json();\r\n      if (!res.ok || json.error) {\r\n        toast({ type: \"error\", message: \"Cập nhật thất bại\" });\r\n        return;\r\n      }\r\n      try {\r\n        const raw2 = localStorage.getItem(\"info_user\");\r\n        const u2 = raw2 ? JSON.parse(raw2) : null;\r\n        if (u2) localStorage.setItem(\"info_user\", JSON.stringify({ ...u2, privacy: next }));\r\n      } catch {}\r\n      setState(next);\r\n      toast({ type: \"success\", message: \"Đã lưu\" });\r\n    } finally {\r\n      setLoadingKey(null);\r\n    }\r\n  };\r\n\r\n  const toggle = (key: keyof PrivacyState) => {\r\n    const next = { ...state, [key]: !state[key] } as PrivacyState;\r\n    void update(next, key);\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-3\">\r\n      <div className=\"flex items-center justify-between px-4 py-3 bg-gray-50 rounded-xl\">\r\n        <span className=\"text-gray-800 font-medium\">Hiển thị trạng thái online</span>\r\n        <button\r\n          onClick={() => toggle(\"showOnline\")}\r\n          className={`px-3 py-1 rounded-lg text-sm ${state.showOnline ? \"bg-indigo-600 text-white\" : \"bg-gray-200 text-gray-800\"}`}\r\n        >\r\n          {loadingKey === \"showOnline\" ? \"...\" : state.showOnline ? \"Bật\" : \"Tắt\"}\r\n        </button>\r\n      </div>\r\n      <div className=\"flex items-center justify-between px-4 py-3 bg-gray-50 rounded-xl\">\r\n        <span className=\"text-gray-800 font-medium\">Cho phép lời mời kết bạn</span>\r\n        <button\r\n          onClick={() => toggle(\"allowFriendRequests\")}\r\n          className={`px-3 py-1 rounded-lg text-sm ${state.allowFriendRequests ? \"bg-indigo-600 text-white\" : \"bg-gray-200 text-gray-800\"}`}\r\n        >\r\n          {loadingKey === \"allowFriendRequests\" ? \"...\" : state.allowFriendRequests ? \"Bật\" : \"Tắt\"}\r\n        </button>\r\n      </div>\r\n      <div className=\"flex items-center justify-between px-4 py-3 bg-gray-50 rounded-xl\">\r\n        <span className=\"text-gray-800 font-medium\">Cho phép gắn thẻ @</span>\r\n        <button\r\n          onClick={() => toggle(\"allowTagging\")}\r\n          className={`px-3 py-1 rounded-lg text-sm ${state.allowTagging ? \"bg-indigo-600 text-white\" : \"bg-gray-200 text-gray-800\"}`}\r\n        >\r\n          {loadingKey === \"allowTagging\" ? \"...\" : state.allowTagging ? \"Bật\" : \"Tắt\"}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n","\"use client\";\r\n\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useToast } from \"@/components/base/toast\";\r\nimport { useChatNotifications } from \"@/hooks/useChatNotifications\";\r\n\r\ninterface NotiState {\r\n  soundEnabled: boolean;\r\n  desktopAlerts: boolean;\r\n  showPreview: boolean;\r\n}\r\n\r\nexport default function NotificationSettings() {\r\n  const toast = useToast();\r\n  const [state, setState] = useState<NotiState>({ soundEnabled: true, desktopAlerts: true, showPreview: true });\r\n  const [loadingKey, setLoadingKey] = useState<string | null>(null);\r\n  const { playMessageSound } = useChatNotifications({});\r\n\r\n  useEffect(() => {\r\n    try {\r\n      const raw = typeof window !== \"undefined\" ? localStorage.getItem(\"info_user\") : null;\r\n      const u = raw ? JSON.parse(raw) : null;\r\n      const prev = (u?.[\"notifications\"] as NotiState) || null;\r\n      if (prev) setState(prev);\r\n    } catch {}\r\n  }, []);\r\n\r\n  const update = async (next: NotiState, key: keyof NotiState) => {\r\n    try {\r\n      setLoadingKey(String(key));\r\n      const raw = typeof window !== \"undefined\" ? localStorage.getItem(\"info_user\") : null;\r\n      const u = raw ? JSON.parse(raw) : null;\r\n      const userId = String(u?.[\"_id\"] || \"\");\r\n      const res = await fetch(\"/api/users\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ action: \"update\", field: \"_id\", value: userId, data: { notifications: next } }),\r\n      });\r\n      const json = await res.json();\r\n      if (!res.ok || json.error) {\r\n        toast({ type: \"error\", message: \"Cập nhật thất bại\" });\r\n        return;\r\n      }\r\n      try {\r\n        const raw2 = localStorage.getItem(\"info_user\");\r\n        const u2 = raw2 ? JSON.parse(raw2) : null;\r\n        if (u2) localStorage.setItem(\"info_user\", JSON.stringify({ ...u2, notifications: next }));\r\n      } catch {}\r\n      setState(next);\r\n      toast({ type: \"success\", message: \"Đã lưu\" });\r\n    } finally {\r\n      setLoadingKey(null);\r\n    }\r\n  };\r\n\r\n  const toggle = (key: keyof NotiState) => {\r\n    const next = { ...state, [key]: !state[key] } as NotiState;\r\n    void update(next, key);\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-3\">\r\n      <div className=\"flex items-center justify-between px-4 py-3 bg-gray-50 rounded-xl\">\r\n        <span className=\"text-gray-800 font-medium\">Âm thanh thông báo</span>\r\n        <button\r\n          onClick={() => toggle(\"soundEnabled\")}\r\n          className={`px-3 py-1 rounded-lg text-sm ${state.soundEnabled ? \"bg-indigo-600 text-white\" : \"bg-gray-200 text-gray-800\"}`}\r\n        >\r\n          {loadingKey === \"soundEnabled\" ? \"...\" : state.soundEnabled ? \"Bật\" : \"Tắt\"}\r\n        </button>\r\n      </div>\r\n      <div className=\"flex items-center justify-between px-4 py-3 bg-gray-50 rounded-xl\">\r\n        <span className=\"text-gray-800 font-medium\">Thử âm thanh</span>\r\n        <button\r\n          onClick={() => {\r\n            if (!state.soundEnabled) {\r\n              toast({ type: \"info\", message: \"Âm thanh đang tắt\" });\r\n              return;\r\n            }\r\n            playMessageSound();\r\n          }}\r\n          className=\"px-3 py-1 rounded-lg text-sm bg-indigo-600 text-white\"\r\n        >\r\n          Phát “ting”\r\n        </button>\r\n      </div>\r\n      <div className=\"flex items-center justify-between px-4 py-3 bg-gray-50 rounded-xl\">\r\n        <span className=\"text-gray-800 font-medium\">Hiện banner desktop</span>\r\n        <button\r\n          onClick={() => toggle(\"desktopAlerts\")}\r\n          className={`px-3 py-1 rounded-lg text-sm ${state.desktopAlerts ? \"bg-indigo-600 text-white\" : \"bg-gray-200 text-gray-800\"}`}\r\n        >\r\n          {loadingKey === \"desktopAlerts\" ? \"...\" : state.desktopAlerts ? \"Bật\" : \"Tắt\"}\r\n        </button>\r\n      </div>\r\n      <div className=\"flex items-center justify-between px-4 py-3 bg-gray-50 rounded-xl\">\r\n        <span className=\"text-gray-800 font-medium\">Hiển thị preview nội dung</span>\r\n        <button\r\n          onClick={() => toggle(\"showPreview\")}\r\n          className={`px-3 py-1 rounded-lg text-sm ${state.showPreview ? \"bg-indigo-600 text-white\" : \"bg-gray-200 text-gray-800\"}`}\r\n        >\r\n          {loadingKey === \"showPreview\" ? \"...\" : state.showPreview ? \"Bật\" : \"Tắt\"}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n","'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport PasswordChange from '@/components/(profile)/profile-setting/PasswordChange';\r\nimport PrivacySettings from '@/components/(profile)/profile-setting/PrivacySettings';\r\nimport NotificationSettings from '@/components/(profile)/profile-setting/NotificationSettings';\r\nimport { HiOutlineLogout } from 'react-icons/hi';\r\n\r\nfunction ProfileSettings() {\r\n  const [open, setOpen] = useState<null | 'password' | 'privacy' | 'notifications'>(null);\r\n  const router = useRouter();\r\n\r\n  const items: Array<{ key: 'password' | 'privacy' | 'notifications'; label: string }> = [\r\n    { key: 'password', label: 'Đổi mật khẩu' },\r\n    { key: 'privacy', label: 'Quyền riêng tư' },\r\n    { key: 'notifications', label: 'Cài đặt thông báo' },\r\n  ];\r\n\r\n  const titleMap: Record<NonNullable<typeof open>, string> = {\r\n    password: 'Đổi mật khẩu',\r\n    privacy: 'Quyền riêng tư',\r\n    notifications: 'Cài đặt thông báo',\r\n  };\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      await fetch('/api/users', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ action: 'logout' }),\r\n      });\r\n    } catch {}\r\n    try {\r\n      localStorage.removeItem('info_user');\r\n      localStorage.removeItem('remember_login');\r\n    } catch {}\r\n    router.push('/login');\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-3\">\r\n      {items.map((item) => (\r\n        <button\r\n          key={item.key}\r\n          onClick={() => setOpen(item.key)}\r\n          className=\"cursor-pointer w-full px-4 py-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg md:text-lg\"\r\n        >\r\n          {item.label}\r\n        </button>\r\n      ))}\r\n      <button\r\n        onClick={handleLogout}\r\n        className=\"cursor-pointer w-full px-4 py-3 text-left bg-red-50 hover:bg-red-100 rounded-lg md:text-lg text-red-600 inline-flex items-center gap-2\"\r\n      >\r\n        <HiOutlineLogout className=\"w-5 h-5\" /> Đăng xuất\r\n      </button>\r\n\r\n      {open && (\r\n        <div className=\"fixed inset-0 z-[9999]\">\r\n          <div className=\"absolute inset-0 bg-black/40 h-[110%]\" onClick={() => setOpen(null)} />\r\n\r\n          <div className=\"hidden md:flex absolute inset-0 items-center justify-center p-4\">\r\n            <div className=\"w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden\">\r\n              <div className=\"flex items-center justify-between px-4 py-3 border-b-gray-300\">\r\n                <span className=\"font-semibold text-gray-800\">{titleMap[open]}</span>\r\n                <button\r\n                  onClick={() => setOpen(null)}\r\n                  className=\"cursor-pointer px-3 py-1 text-sm font-medium rounded-lg bg-gray-100 hover:bg-gray-200\"\r\n                >\r\n                  Đóng\r\n                </button>\r\n              </div>\r\n              <div className=\"p-4\">\r\n                {open === 'password' && <PasswordChange />}\r\n                {open === 'privacy' && <PrivacySettings />}\r\n                {open === 'notifications' && <NotificationSettings />}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"md:hidden absolute inset-x-0 bottom-0 p-5\">\r\n            <div className=\"bg-white rounded-t-2xl shadow-2xl overflow-hidden\">\r\n              <div className=\"flex items-center justify-between px-4 py-3 border-b-gray-300 border-b\">\r\n                <span className=\"font-semibold text-gray-800\">{titleMap[open]}</span>\r\n                <button\r\n                  onClick={() => setOpen(null)}\r\n                  className=\"cursor-pointer px-3 py-1 text-sm font-medium rounded-lg bg-gray-100 hover:bg-gray-200\"\r\n                >\r\n                  Đóng\r\n                </button>\r\n              </div>\r\n              <div className=\"p-4 max-h-[70vh] overflow-y-auto\">\r\n                {open === 'password' && <PasswordChange />}\r\n                {open === 'privacy' && <PrivacySettings />}\r\n                {open === 'notifications' && <NotificationSettings />}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ProfileSettings;\r\n","'use client';\r\n\r\nexport default function ProfileOverview({\r\n  data,\r\n}: {\r\n  data: {\r\n    phone: string;\r\n    gender: string;\r\n    birthday: string;\r\n    email: string;\r\n    address: string;\r\n    department: string;\r\n    title: string;\r\n  };\r\n}) {\r\n  const departmentOptions = [\r\n    {\r\n      id: 1,\r\n      name: 'Ban lãnh đạo',\r\n    },\r\n    {\r\n      id: 2,\r\n      name: 'Quản lý',\r\n    },\r\n    {\r\n      id: 3,\r\n      name: 'Kinh doanh',\r\n    },\r\n    {\r\n      id: 4,\r\n      name: 'Thiết kế',\r\n    },\r\n    {\r\n      id: 5,\r\n      name: 'Sản xuất',\r\n    },\r\n    {\r\n      id: 6,\r\n      name: 'Sàn TMĐT',\r\n    },\r\n    {\r\n      id: 7,\r\n      name: 'Kế toán',\r\n    },\r\n    {\r\n      id: 8,\r\n      name: 'Kho TM',\r\n    },\r\n    {\r\n      id: 9,\r\n      name: 'HCNS',\r\n    },\r\n    {\r\n      id: 10,\r\n      name: 'Maketing',\r\n    },\r\n  ];\r\n  const deptLabel =\r\n    departmentOptions.find((o) => o.id === Number(data.department))?.name || data.department || 'Chưa cập nhật';\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg p-4\">\r\n      <h3 className=\"text-lg font-bold text-gray-900 mb-4\">Thông tin cá nhân</h3>\r\n\r\n      <div className=\"space-y-4\">\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Giới tính</span>\r\n          <span className=\"text-gray-900 font-medium flex-1 text-right\">{data.gender || 'Chưa cập nhật'}</span>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Ngày sinh</span>\r\n          <span className=\"text-gray-900 font-medium flex-1 text-right\">{data.birthday || 'Chưa cập nhật'}</span>\r\n        </div>\r\n\r\n        <div className=\"py-2 border-b border-gray-100\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <span className=\"text-gray-500 w-32\">Điện thoại</span>\r\n            <span className=\"text-gray-900 font-medium flex-1 text-right\">{data.phone || 'Chưa cập nhật'}</span>\r\n          </div>\r\n          <p className=\"text-xs text-gray-500 mt-2 pl-32\">\r\n            Số điện thoại chỉ hiển thị với người có lưu số bạn trong danh bạ máy\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Email</span>\r\n          <span className=\"text-gray-900 font-medium flex-1 text-right\">{data.email || 'Chưa cập nhật'}</span>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Địa chỉ</span>\r\n          <span className=\"text-gray-900 font-medium flex-1 text-right\">{data.address || 'Chưa cập nhật'}</span>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Phòng ban</span>\r\n          <span className=\"text-gray-900 font-medium flex-1 text-right\">{deptLabel}</span>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Chức vụ</span>\r\n          <span className=\"text-gray-900 font-medium flex-1 text-right\">{data.title || 'Chưa cập nhật'}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","// components/(profile)/InfoRow.tsx\r\nimport React from 'react';\r\nimport { HiUser, HiPhone, HiCalendar, HiEnvelope, HiMapPin, HiBuildingOffice2, HiBriefcase } from 'react-icons/hi2';\r\n\r\nconst iconMap: Record<string, React.ReactNode> = {\r\n  user: <HiUser className=\"w-6 h-6 text-gray-500\" />,\r\n  phone: <HiPhone className=\"w-6 h-6 text-gray-500\" />,\r\n  calendar: <HiCalendar className=\"w-6 h-6 text-gray-500\" />,\r\n  email: <HiEnvelope className=\"w-6 h-6 text-gray-500\" />,\r\n  location: <HiMapPin className=\"w-6 h-6 text-gray-500\" />,\r\n  building: <HiBuildingOffice2 className=\"w-6 h-6 text-gray-500\" />,\r\n  briefcase: <HiBriefcase className=\"w-6 h-6 text-gray-500\" />,\r\n};\r\n\r\ninterface InfoRowProps {\r\n  icon?: keyof typeof iconMap;\r\n  label: string;\r\n  value: string;\r\n  badge?: React.ReactNode;\r\n}\r\n\r\nexport default function InfoRow({ icon, label, value, badge }: InfoRowProps) {\r\n  return (\r\n    <div className=\"flex items-center justify-between bg-white rounded-2xl px-6 py-3 shadow-sm border border-gray-100 hover:shadow-md transition-shadow\">\r\n      <div className=\"flex items-center gap-4\">\r\n        {icon ? iconMap[icon] : null}\r\n        <span className=\"text-gray-600 font-medium text-base\">{label}</span>\r\n      </div>\r\n      <div className=\"text-right\">\r\n        <p className=\"font-semibold text-gray-900 text-base\">{value}</p>\r\n        {badge && <div className=\"mt-1.5\">{badge}</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","// components/(profile)/ProfileInfoView.tsx\r\n\r\nimport InfoRow from '@/components/(profile)/InforRow';\r\n\r\nconst departments: Record<string, { label: string; color: string }> = {\r\n  '1': { label: 'Ban lãnh đạo', color: 'bg-pink-100 text-pink-700' },\r\n  '2': { label: 'Quản lý', color: 'bg-purple-100 text-purple-700' },\r\n  '3': { label: 'Kinh doanh', color: 'bg-blue-100 text-blue-700' },\r\n  '4': { label: 'Thiết kế', color: 'bg-green-100 text-green-700' },\r\n  '5': { label: 'Sản xuất', color: 'bg-yellow-100 text-yellow-700' },\r\n  '6': { label: 'Sàn TMĐT', color: 'bg-orange-100 text-orange-700' },\r\n  '7': { label: 'Kế toán', color: 'bg-red-100 text-red-700' },\r\n  '8': { label: 'Kho TM', color: 'bg-gray-100 text-gray-700' },\r\n  '9': { label: 'HCNS', color: 'bg-teal-100 text-teal-700' },\r\n  '10': { label: 'Maketing', color: 'bg-pink-100 text-pink-700' },\r\n};\r\n\r\nexport default function ProfileInfoView({\r\n  form,\r\n}: {\r\n  form: {\r\n    name?: string;\r\n    phone?: string;\r\n    gender?: string;\r\n    birthday?: string;\r\n    email?: string;\r\n    address?: string;\r\n    department?: string;\r\n    title?: string;\r\n  };\r\n}) {\r\n  const dept = form.department ? departments[form.department] : undefined;\r\n\r\n  return (\r\n    <div className=\"space-y-4 max-w-2xl mx-auto\">\r\n      <InfoRow icon=\"user\" label=\"Tên hiển thị\" value={form.name || 'Chưa đặt'} />\r\n      <InfoRow icon=\"phone\" label=\"Số điện thoại\" value={form.phone || 'Chưa đặt'} />\r\n      <InfoRow icon=\"user\" label=\"Giới tính\" value={form.gender || 'Chưa chọn'} />\r\n      <InfoRow icon=\"calendar\" label=\"Ngày sinh\" value={form.birthday || 'Chưa chọn'} />\r\n      <InfoRow icon=\"email\" label=\"Email\" value={form.email || 'Chưa đặt'} />\r\n      <InfoRow icon=\"location\" label=\"Địa chỉ\" value={form.address || 'Chưa đặt'} />\r\n      <InfoRow\r\n        icon=\"building\"\r\n        label=\"Phòng ban\"\r\n        value={dept?.label || 'Chưa xác định'}\r\n        badge={dept && <span className={`px-3 py-1 rounded-full text-xs font-medium ${dept.color}`}>{dept.label}</span>}\r\n      />\r\n      <InfoRow icon=\"briefcase\" label=\"Chức vụ\" value={form.title || 'Chưa đặt'} />\r\n    </div>\r\n  );\r\n}\r\n","/* eslint-disable @typescript-eslint/no-unused-vars */\r\nimport DepartmentDropdown from '@/components/(profile)/DepartmentDropdown';\r\nimport GenderSelector from '@/components/(profile)/GenderSelector';\r\nimport InputField from '@/components/(profile)/InputField';\r\nimport { useState } from 'react';\r\nimport { HiChevronDown } from 'react-icons/hi';\r\nimport { HiCheck } from 'react-icons/hi2';\r\n\r\ninterface Props {\r\n  form: {\r\n    name: string;\r\n    phone: string;\r\n    gender: string;\r\n    birthday: string;\r\n    email: string;\r\n    address: string;\r\n    department: string;\r\n    title: string;\r\n  };\r\n  setForm: (form: Props['form']) => void;\r\n  isSaving: boolean;\r\n  onSave: () => void;\r\n}\r\n\r\nexport default function ProfileInfoEdit({ form, setForm, isSaving, onSave }: Props) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [isOpenDepartment, setIsOpenDepartment] = useState(false);\r\n  const departmentOptions = [\r\n    {\r\n      id: 1,\r\n      name: 'Ban lãnh đạo',\r\n    },\r\n    {\r\n      id: 2,\r\n      name: 'Quản lý',\r\n    },\r\n    {\r\n      id: 3,\r\n      name: 'Kinh doanh',\r\n    },\r\n    {\r\n      id: 4,\r\n      name: 'Thiết kế',\r\n    },\r\n    {\r\n      id: 5,\r\n      name: 'Sản xuất',\r\n    },\r\n    {\r\n      id: 6,\r\n      name: 'Sàn TMĐT',\r\n    },\r\n    {\r\n      id: 7,\r\n      name: 'Kế toán',\r\n    },\r\n    {\r\n      id: 8,\r\n      name: 'Kho TM',\r\n    },\r\n    {\r\n      id: 9,\r\n      name: 'HCNS',\r\n    },\r\n    {\r\n      id: 10,\r\n      name: 'Maketing',\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg p-4\">\r\n      <h3 className=\"text-lg font-bold text-gray-900 mb-4\">Chỉnh sửa thông tin</h3>\r\n\r\n      <div className=\"space-y-4\">\r\n        {/* Tên hiển thị */}\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Tên hiển thị</span>\r\n          <input\r\n            className=\"flex-1 text-right text-gray-900 font-medium focus:outline-none placeholder-gray-400\"\r\n            value={form.name}\r\n            onChange={(e) => setForm({ ...form, name: e.target.value })}\r\n            placeholder=\"Chưa cập nhật\"\r\n          />\r\n        </div>\r\n\r\n        {/* Giới tính */}\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Giới tính</span>\r\n          <div className=\"relative\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setIsOpen(!isOpen)}\r\n              className={`\r\n      w-full px-5 p-2 rounded-2xl  text-base font-medium text-left cursor-pointer\r\n      flex items-center justify-between transition-all duration-200\r\n      focus:outline-none\r\n      ${isOpen ? 'bg-white ring-4 ring-[#0068ff]/20 border-2 border-[#0068ff]' : 'border-2 border-transparent '}\r\n      ${form.gender ? 'text-gray-900' : 'text-gray-500'}\r\n    `}\r\n            >\r\n              <span>{form.gender || 'Chưa cập nhật'}</span>\r\n              <HiChevronDown\r\n                className={`w-5 h-5 text-gray-500 transition-transform duration-300 ${isOpen ? 'rotate-180' : ''}`}\r\n              />\r\n            </button>\r\n\r\n            {/* Dropdown menu */}\r\n            {isOpen && (\r\n              <>\r\n                {/* Backdrop để đóng khi click ngoài */}\r\n                <div className=\"fixed inset-0 z-40\" onClick={() => setIsOpen(false)} />\r\n\r\n                {/* Danh sách lựa chọn */}\r\n                <div className=\"absolute top-full left-0 right-0 mt-2 bg-white rounded-2xl shadow-xl border border-gray-200 overflow-hidden z-50\">\r\n                  {['Nam', 'Nữ', 'Khác'].map((option) => (\r\n                    <button\r\n                      key={option}\r\n                      type=\"button\"\r\n                      onClick={() => {\r\n                        setForm({ ...form, gender: option });\r\n                        setIsOpen(false);\r\n                      }}\r\n                      className={`\r\n              w-full px-5 py-4 text-left font-medium transition-all duration-150 cursor-pointer\r\n              ${form.gender === option ? 'bg-[#0068ff]/5 text-[#0068ff]' : 'text-gray-800 hover:bg-gray-100'}\r\n              active:bg-gray-200 flex items-center justify-between\r\n            `}\r\n                    >\r\n                      <span>{option}</span>\r\n                      {form.gender === option && <HiCheck className=\"w-5 h-5 text-[#0068ff]\" />}\r\n                    </button>\r\n                  ))}\r\n\r\n                  {/* Option \"Chưa cập nhật\" */}\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Ngày sinh */}\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100 \">\r\n          <span className=\"text-gray-500 w-32\">Ngày sinh</span>\r\n          <input\r\n            type=\"date\"\r\n            className=\"flex-1 text-right cursor-pointer text-gray-900 font-medium focus:outline-none bg-transparent\"\r\n            value={form.birthday}\r\n            onChange={(e) => setForm({ ...form, birthday: e.target.value })}\r\n          />\r\n        </div>\r\n\r\n        {/* Điện thoại */}\r\n        <div className=\"py-2 border-b border-gray-100\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <span className=\"text-gray-500 w-32\">Điện thoại</span>\r\n            <input\r\n              type=\"tel\"\r\n              className=\"flex-1 text-right text-gray-900 font-medium focus:outline-none placeholder-gray-400\"\r\n              value={form.phone}\r\n              onChange={(e) => setForm({ ...form, phone: e.target.value })}\r\n              placeholder=\"Chưa cập nhật\"\r\n            />\r\n          </div>\r\n          <p className=\"text-xs text-gray-500 mt-2 pl-32\">\r\n            Số điện thoại chỉ hiển thị với người có lưu số bạn trong danh bạ máy\r\n          </p>\r\n        </div>\r\n\r\n        {/* Email */}\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Email</span>\r\n          <input\r\n            type=\"email\"\r\n            className=\"flex-1 text-right text-gray-900 font-medium focus:outline-none placeholder-gray-400\"\r\n            value={form.email}\r\n            onChange={(e) => setForm({ ...form, email: e.target.value })}\r\n            placeholder=\"Chưa cập nhật\"\r\n          />\r\n        </div>\r\n\r\n        {/* Địa chỉ */}\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Địa chỉ</span>\r\n          <input\r\n            className=\"flex-1 text-right text-gray-900 font-medium focus:outline-none placeholder-gray-400\"\r\n            value={form.address}\r\n            onChange={(e) => setForm({ ...form, address: e.target.value })}\r\n            placeholder=\"Chưa cập nhật\"\r\n          />\r\n        </div>\r\n\r\n        {/* Phòng ban */}\r\n        <div className=\"flex justify-between items-center py-4 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 text-base w-32\">Phòng ban</span>\r\n\r\n          {/* Custom Dropdown thay thế <select> */}\r\n          <div className=\"flex-1 relative\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setIsOpenDepartment(!isOpenDepartment)}\r\n              className={`\r\n        w-full px-4 py-1 text-right font-medium text-base transition-all duration-200 cursor-pointer\r\n        flex items-center justify-end gap-3\r\n        ${form.department ? 'text-gray-900' : 'text-gray-500'}\r\n        focus:outline-none\r\n      `}\r\n            >\r\n              <span className=\"truncate max-w-[180px]\">\r\n                {departmentOptions.find((opt) => String(opt.id) === form.department)?.name || 'Chưa cập nhật'}\r\n              </span>\r\n              <HiChevronDown\r\n                className={`w-5 h-5 text-gray-500 transition-transform duration-300 flex-shrink-0 ${isOpenDepartment ? 'rotate-180' : ''}`}\r\n              />\r\n            </button>\r\n\r\n            {/* Dropdown menu */}\r\n            {isOpenDepartment && (\r\n              <>\r\n                {/* Backdrop đóng khi click ngoài */}\r\n                <div className=\"fixed inset-0 z-40\" onClick={() => setIsOpenDepartment(false)} />\r\n\r\n                {/* Danh sách lựa chọn */}\r\n                <div className=\"absolute h-[24rem] overflow-y-auto right-0 custom-scrollbar bottom-full mt-2 w-64 bg-white rounded-2xl shadow-xl border border-gray-200 overflow-hidden z-50\">\r\n                  {/* Option \"Chưa cập nhật\" */}\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => {\r\n                      setForm({ ...form, department: '' });\r\n                      setIsOpenDepartment(false);\r\n                    }}\r\n                    className={`\r\n              w-full px-5 py-4 text-left font-medium transition-all duration-150 cursor-pointer\r\n              ${!form.department ? 'bg-[#0068ff]/5 text-[#0068ff]' : 'text-gray-800 hover:bg-gray-100'}\r\n              active:bg-gray-200 flex items-center justify-between\r\n            `}\r\n                  >\r\n                    <span>Chưa cập nhật</span>\r\n                    {!form.department && <HiCheck className=\"w-5 h-5 text-[#0068ff]\" />}\r\n                  </button>\r\n\r\n                  {/* Các phòng ban */}\r\n                  {departmentOptions.map((opt) => (\r\n                    <button\r\n                      key={opt.id}\r\n                      type=\"button\"\r\n                      onClick={() => {\r\n                        setForm({ ...form, department: String(opt.id) });\r\n                        setIsOpenDepartment(false);\r\n                      }}\r\n                      className={`\r\n                w-full px-5 py-4 text-left font-medium transition-all duration-150 cursor-pointer border-t border-gray-100\r\n                ${form.department === String(opt.id) ? 'bg-[#0068ff]/5 text-[#0068ff]' : 'text-gray-800 hover:bg-gray-100'}\r\n                active:bg-gray-200 flex items-center justify-between\r\n              `}\r\n                    >\r\n                      <span>{opt.name}</span>\r\n                      {form.department === String(opt.id) && <HiCheck className=\"w-5 h-5 text-[#0068ff]\" />}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n        {/* Chức vụ */}\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Chức vụ</span>\r\n          <input\r\n            className=\"flex-1 text-right text-gray-900 font-medium focus:outline-none placeholder-gray-400\"\r\n            value={form.title}\r\n            onChange={(e) => setForm({ ...form, title: e.target.value })}\r\n            placeholder=\"Chưa cập nhật\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <button\r\n        onClick={onSave}\r\n        disabled={isSaving}\r\n        className=\"w-full mt-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-semibold rounded-full shadow-sm transition-all duration-200 active:scale-95 flex items-center justify-center gap-2 cursor-pointer\"\r\n      >\r\n        {isSaving ? (\r\n          'Đang lưu...'\r\n        ) : (\r\n          <>\r\n            <HiCheck className=\"w-5 h-5\" />\r\n            Lưu thông tin\r\n          </>\r\n        )}\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n","// components/(profile)/ProfileInfo.tsx\r\n'use client';\r\n\r\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport { useSearchParams } from 'next/navigation';\r\nimport { useToast } from '@/components/base/toast';\r\n\r\nimport ProfileInfoView from './ProfileInfoView';\r\nimport ProfileInfoEdit from './ProfileInfoEdit';\r\n\r\nimport { HiPencil } from 'react-icons/hi2';\r\n\r\nexport function ProfileInfo({\r\n  onDataChange,\r\n  isOwner: isOwnerProp,\r\n}: {\r\n  onDataChange?: (data: Record<string, unknown>) => void;\r\n  isOwner?: boolean;\r\n}) {\r\n  const searchParams = useSearchParams();\r\n  const toast = useToast();\r\n  const [form, setForm] = useState({\r\n    name: '',\r\n    phone: '',\r\n    gender: '',\r\n    birthday: '',\r\n    email: '',\r\n    address: '',\r\n    department: '',\r\n    title: '',\r\n  });\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [isEditing, setIsEditing] = useState(false);\r\n\r\n  const [mounted, setMounted] = useState(false);\r\n  useEffect(() => {\r\n    setMounted(true);\r\n  }, []);\r\n\r\n  const currentUser = useMemo(() => {\r\n    try {\r\n      const raw = typeof window !== 'undefined' ? localStorage.getItem('info_user') : null;\r\n      return raw ? JSON.parse(raw) : null;\r\n    } catch {\r\n      return null;\r\n    }\r\n  }, []);\r\n\r\n  const currentId = useMemo(() => String(currentUser?.['username'] || currentUser?.['_id'] || ''), [currentUser]);\r\n  const viewingId = searchParams.get('user') || '';\r\n  const isOwner = isOwnerProp ?? (currentId && viewingId && currentId === viewingId);\r\n\r\n  const initializedRef = useRef(false);\r\n  useEffect(() => {\r\n    if (initializedRef.current || !currentUser) return;\r\n    const newForm = {\r\n      name: String(currentUser['name'] || currentUser['username'] || ''),\r\n      phone: String(currentUser['phone'] || ''),\r\n      gender: String(currentUser['gender'] || ''),\r\n      birthday: String(currentUser['birthday'] || ''),\r\n      email: String(currentUser['email'] || ''),\r\n      address: String(currentUser['address'] || ''),\r\n      department: String(currentUser['department'] || ''),\r\n      title: String(currentUser['title'] || ''),\r\n    };\r\n    setForm(newForm);\r\n    initializedRef.current = true;\r\n    onDataChange?.(newForm);\r\n  }, [currentUser, onDataChange]);\r\n\r\n  const handleSave = async () => {\r\n    if (!isOwner) return;\r\n    setIsSaving(true);\r\n    try {\r\n      const res = await fetch('/api/users', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          action: 'update',\r\n          field: currentUser?.['username'] ? 'username' : '_id',\r\n          value: currentId,\r\n          data: form,\r\n        }),\r\n      });\r\n      const json = await res.json();\r\n      if (!res.ok || json.error) throw new Error(json.error || 'Lưu thất bại');\r\n\r\n      localStorage.setItem('info_user', JSON.stringify({ ...currentUser, ...form }));\r\n      onDataChange?.(form);\r\n      toast({ type: 'success', message: 'Đã lưu thông tin!' });\r\n      setIsEditing(false);\r\n    } catch (err: unknown) {\r\n      toast({ type: 'error', message: (err as Error).message || 'Lỗi hệ thống' });\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  if (!mounted) return null;\r\n\r\n  if (!isOwner) return <ProfileInfoView form={form} />;\r\n\r\n  if (isEditing) {\r\n    return <ProfileInfoEdit form={form} setForm={setForm} isSaving={isSaving} onSave={handleSave} />;\r\n  }\r\n\r\n  const departmentOptions = [\r\n    { id: 2, name: 'Quản lý' },\r\n    { id: 3, name: 'Kinh doanh' },\r\n    { id: 4, name: 'Thiết kế' },\r\n    { id: 5, name: 'Sản xuất' },\r\n    { id: 6, name: 'Sàn TMĐT' },\r\n    { id: 7, name: 'Kế toán' },\r\n    { id: 8, name: 'Kho TM' },\r\n    { id: 9, name: 'HCNS' },\r\n    { id: 10, name: 'Maketing' },\r\n  ];\r\n  const deptLabel =\r\n    departmentOptions.find((o) => o.id === Number(form.department))?.name || form.department || 'Chưa cập nhật';\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg p-4\">\r\n      <h3 className=\"text-lg font-bold text-gray-900 mb-4\">Thông tin cá nhân</h3>\r\n\r\n      <div className=\"space-y-4\">\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Tên hiển thị</span>\r\n          <span className=\"text-gray-900 font-medium flex-1 text-right\">{form.name || 'Chưa cập nhật'}</span>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Giới tính</span>\r\n          <span className=\"text-gray-900 font-medium flex-1 text-right\">{form.gender || 'Chưa cập nhật'}</span>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Ngày sinh</span>\r\n          <span className=\"text-gray-900 font-medium flex-1 text-right\">{form.birthday || 'Chưa cập nhật'}</span>\r\n        </div>\r\n\r\n        <div className=\"py-2 border-b border-gray-100\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <span className=\"text-gray-500 w-32\">Điện thoại</span>\r\n            <span className=\"text-gray-900 font-medium flex-1 text-right\">{form.phone || 'Chưa cập nhật'}</span>\r\n          </div>\r\n          <p className=\"text-xs text-gray-500 mt-2 pl-32\">\r\n            Số điện thoại chỉ hiển thị với người có lưu số bạn trong danh bạ máy\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Email</span>\r\n          <span className=\"text-gray-900 font-medium flex-1 text-right\">{form.email || 'Chưa cập nhật'}</span>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Địa chỉ</span>\r\n          <span className=\"text-gray-900 font-medium flex-1 text-right\">{form.address || 'Chưa cập nhật'}</span>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Phòng ban</span>\r\n          <span className=\"text-gray-900 font-medium flex-1 text-right\">{deptLabel}</span>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center py-2 border-b border-gray-100\">\r\n          <span className=\"text-gray-500 w-32\">Chức vụ</span>\r\n          <span className=\"text-gray-900 font-medium flex-1 text-right\">{form.title || 'Chưa cập nhật'}</span>\r\n        </div>\r\n      </div>\r\n\r\n      <button\r\n        onClick={() => setIsEditing(true)}\r\n        className=\"w-full mt-6 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 rounded-full flex items-center justify-center gap-2 transition-colors cursor-pointer\"\r\n      >\r\n        <HiPencil className=\"w-4 h-4\" />\r\n        Chỉnh sửa\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ProfileInfo;\r\n","'use client';\r\n/* eslint-disable @typescript-eslint/no-unused-vars */\r\n\r\nimport ProfileQR from '@/components/(profile)/PorfileQR';\r\nimport ProfileSettings from '@/components/(profile)/ProfileSettings';\r\nimport ProfileOverview from '@/components/(profile)/ProfileOverview';\r\nimport { ProfileInfo } from '@/components/(profile)/ProfileInfo';\r\n\r\nimport { HiUser, HiQrCode, HiCog6Tooth, HiInformationCircle } from 'react-icons/hi2';\r\n\r\nexport default function ProfileContent({\n  tab,\n  isOwner,\n  overviewData,\n  handleOverviewData,\n  profileIdForQr,\n}: {\n  tab: string;\n  isOwner: boolean;\n  overviewData: Record<string, unknown>;\n  handleOverviewData: (data: Record<string, unknown>) => void;\n  profileIdForQr: string;\n}) {\n  return (\n    <div className=\"\">\n      <div className=\"animate-in fade-in slide-in-from-bottom-4 duration-500 delay-100\">\n        {/* Thông tin cá nhân (chỉ owner chỉnh sửa được) */}\r\n        {tab === 'info' && (\r\n          <>\r\n            {isOwner ? (\r\n              <ProfileInfo\r\n                isOwner={isOwner}\r\n                onDataChange={(data) => handleOverviewData(data as Record<string, unknown>)}\r\n              />\r\n            ) : (\r\n              <ProfileOverview\r\n                data={\r\n                  overviewData as {\r\n                    phone: string;\r\n                    gender: string;\r\n                    birthday: string;\r\n                    email: string;\r\n                    address: string;\r\n                    department: string;\r\n                    title: string;\r\n                  }\r\n                }\r\n              />\r\n            )}\r\n          </>\r\n        )}\r\n\r\n        {/* Mã QR */}\r\n        {tab === 'qr' && (\n          <div className=\"bg-white rounded-lg p-4\">\n            <h3 className=\"text-lg font-bold text-gray-900 mb-4\">Mã QR</h3>\n            <div className=\"flex justify-center py-6\">\n              <div className=\" p-2  \">\n                <ProfileQR profilePath={profileIdForQr ? `/profile/${encodeURIComponent(profileIdForQr)}` : ''} />\n              </div>\n            </div>\n          </div>\n        )}\n\r\n        {/* Cài đặt – chỉ owner */}\r\n        {tab === 'settings' && isOwner && (\r\n          <div className=\"bg-white rounded-lg p-4\">\r\n            <h3 className=\"text-lg font-bold text-gray-900 mb-4\">Cài đặt</h3>\r\n            <ProfileSettings />\r\n          </div>\r\n        )}\r\n\r\n        {/* Hồ sơ công khai (profile tab) */}\r\n        {tab === 'profile' && (\r\n          <ProfileOverview\r\n            data={\r\n              overviewData as {\r\n                phone: string;\r\n                gender: string;\r\n                birthday: string;\r\n                email: string;\r\n                address: string;\r\n                department: string;\r\n                title: string;\r\n              }\r\n            }\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      {/* Empty state nếu không có gì (hiếm khi xảy ra) */}\r\n      {!['info', 'qr', 'settings', 'profile'].includes(tab) && (\r\n        <div className=\"text-center py-20 text-gray-500\">\r\n          <p className=\"text-lg\">Chưa có nội dung</p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { HiChevronLeft } from 'react-icons/hi2';\r\nimport { createPortal } from 'react-dom';\r\n\r\ninterface MobileProfileSheetProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  title: string;\r\n  children: React.ReactNode;\r\n  rightAction?: React.ReactNode;\r\n  headerClassName?: string;\r\n  titleClassName?: string;\r\n  backButtonClassName?: string;\r\n}\r\n\r\nexport default function MobileProfileSheet({\r\n  isOpen,\r\n  onClose,\r\n  title,\r\n  children,\r\n  rightAction,\r\n  headerClassName = '',\r\n  titleClassName = '',\r\n  backButtonClassName = '',\r\n}: MobileProfileSheetProps) {\r\n  const [mounted, setMounted] = useState(false);\r\n  const [shouldRender, setShouldRender] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setMounted(true);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setShouldRender(true);\r\n      // Prevent body scroll\r\n      document.body.style.overflow = 'hidden';\r\n    } else {\r\n      const timer = setTimeout(() => setShouldRender(false), 300); // Wait for animation\r\n      document.body.style.overflow = '';\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [isOpen]);\r\n\r\n  if (!mounted) return null;\r\n\r\n  // Use portal if needed, but for now rendering inline is fine as long as it covers everything.\r\n  // Using portal is safer for z-index.\r\n  if (!shouldRender) return null;\r\n\r\n  return createPortal(\r\n    <div className=\"fixed inset-0 z-[9999] flex justify-center items-end md:items-center\">\r\n      {/* Backdrop */}\r\n      <div\r\n        className={`absolute inset-0 bg-black/20 backdrop-blur-sm transition-opacity duration-300 ${\r\n          isOpen ? 'opacity-100' : 'opacity-0'\r\n        }`}\r\n        onClick={onClose}\r\n      />\r\n\r\n      {/* Sheet Container */}\r\n      <div\r\n        className={`relative w-full h-full md:h-[90vh] md:max-w-[480px] md:rounded-3xl md:overflow-hidden bg-white shadow-2xl transition-all duration-300 ease-in-out transform flex flex-col ${\r\n          isOpen ? 'translate-x-0 opacity-100 scale-100' : 'translate-x-full md:translate-x-0 md:opacity-0 md:scale-95'\r\n        }`}\r\n      >\r\n        {/* Header */}\r\n        <div\r\n          className={`flex-none p-2 border-b border-gray-100 flex items-center justify-between sticky top-0 z-10 ${\r\n            headerClassName || 'bg-white/80 backdrop-blur-md'\r\n          }`}\r\n        >\r\n          <button\r\n            onClick={onClose}\r\n            className={`p-2 -ml-2 rounded-full transition-colors cursor-pointer ${\r\n              backButtonClassName || 'text-gray-600 hover:bg-gray-100 active:bg-gray-200'\r\n            }`}\r\n          >\r\n            <HiChevronLeft className=\"w-6 h-6\" />\r\n          </button>\r\n\r\n          <h2 className={`text-lg font-bold flex-1 text-center pr-8 ${titleClassName || 'text-gray-800'}`}>{title}</h2>\r\n          {rightAction && <div className=\"absolute right-4\">{rightAction}</div>}\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"flex-1 overflow-y-auto bg-gray-50 custom-scrollbar\">{children}</div>\r\n      </div>\r\n    </div>,\r\n    document.body,\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}