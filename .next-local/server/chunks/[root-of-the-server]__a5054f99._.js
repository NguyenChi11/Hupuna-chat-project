module.exports=[54799,(e,t,n)=>{t.exports=e.x("crypto",()=>require("crypto"))},75601,e=>{"use strict";var t=e.i(54799),n=e.i(36973);async function r(e){let{db:r}=await (0,n.connectToDatabase)(),{userId:s,deviceName:a="web",ip:i="",headers:o={},ttlDays:l=7}=e,c=t.default.randomBytes(32).toString("hex"),d=t.default.createHash("sha256").update((o["user-agent"]||"")+"|"+(o["accept-language"]||"")).digest("hex"),u=new Date,p=new Date(Date.now()+24*l*36e5);return await r.collection("sessions").insertOne({_id:c,userId:s,deviceName:a,deviceFingerprint:d,ip:i,createdAt:u,lastSeenAt:u,expiresAt:p,isRevoked:!1}),c}async function s(e){let{db:t}=await (0,n.connectToDatabase)();if(!e)return null;let r=await t.collection("sessions").findOne({_id:e});return!r||r.isRevoked||r.expiresAt<new Date?null:r}function a(e){return t.default.createHash("sha256").update((e["user-agent"]||"")+"|"+(e["accept-language"]||"")).digest("hex")}e.s(["createSession",()=>r,"fingerprintFromHeaders",()=>a,"getSession",()=>s])},22437,e=>{"use strict";e.s(["USERS_COLLECTION_NAME",0,"Users"])},70406,(e,t,n)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},18622,(e,t,n)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,n)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,n)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,n)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},93695,(e,t,n)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},81769,(e,t,n)=>{t.exports=e.x("mongodb",()=>require("mongodb"))},36973,e=>{"use strict";var t=e.i(81769);let n=process.env.MONGODB_URI||"mongodb://localhost:27017/",r=process.env.MONGODB_DB||"hupuna-price",s=null,a=null;async function i(){if(s&&a)return{client:s,db:a};(n.includes("localhost")||n.includes("127.0.0.1"))&&console.error("âŒ ERROR: You are using a localhost MongoDB URI in production. Please set MONGODB_URI in your Vercel project settings to a remote database (e.g., MongoDB Atlas).");let e=new t.MongoClient(n);await e.connect();let i=e.db(r);return s=e,a=i,{client:e,db:i}}e.s(["connectToDatabase",()=>i])},58632,e=>{"use strict";var t=e.i(81769),n=e.i(36973);let r=async(e,{id:r,code:s,_id:a})=>{let{db:i}=await (0,n.connectToDatabase)(),o={};a&&(t.ObjectId.isValid(a)?o._id=new t.ObjectId(a):isNaN(Number(a))||(o._id=Number(a))),r&&(o.id=r),s&&(o.code=s);let l=await i.collection(e).findOne(o);return l?{rowIndex:0,row:l}:null},s=async(e,{search:t,skip:r=0,limit:s,field:a,value:i,filters:o,sort:l,collation:c}={})=>{let{db:d}=await (0,n.connectToDatabase)(),u=d.collection(e),p={};if(a&&void 0!==i&&(p[a]=i),o&&Object.keys(o).length>0){for(let[e,t]of Object.entries(o))if(null!=t){if("$or"===e||"$and"===e||"object"==typeof t&&null!==t&&("$gte"in t||"$lte"in t)||"object"==typeof t&&null!==t&&Object.keys(t).some(e=>["$in","$nin","$gte","$lte","$gt","$lt","$ne"].includes(e))){p[e]=t;continue}if("string"==typeof t&&t.trim().startsWith("#")){p[e]={$regex:t.trim().slice(1),$options:"i"};continue}p[e]=t}}if(t){let e=await u.findOne();if(e){let n=(e,t="")=>{let r=[];for(let[s,a]of Object.entries(e)){let e=t?`${t}.${s}`:s;"string"==typeof a?r.push(e):a&&"object"==typeof a&&!Array.isArray(a)&&(r=r.concat(n(a,e)))}return r},r=n(e);r.length>0&&(p.$or=r.map(e=>({[e]:{$regex:t,$options:"i"}})))}}let g={};l&&(g=(Array.isArray(l)?l:[l]).reduce((e,t)=>(e[t.field]="desc"===t.order?-1:1,e),{}));let y=await u.countDocuments(p,c?{collation:c}:void 0),x=u.find(p);return c&&(x=x.collation(c)),{total:y,data:await x.sort(g).skip(r).limit(s??0).toArray()}},a=async(e,t)=>{let{db:r}=await (0,n.connectToDatabase)();return(await r.collection(e).insertOne(t)).insertedId.toString()};async function i(e){let{db:t}=await (0,n.connectToDatabase)();return t.collection(e)}let o=async(e,r,s,a)=>{let{db:i}=await (0,n.connectToDatabase)();"_id"in a&&delete a._id;let o=s;return"_id"===r&&"string"==typeof s&&(t.ObjectId.isValid(s)?o=new t.ObjectId(s):isNaN(Number(s))||(o=Number(s))),(await i.collection(e).updateOne({[r]:o},{$set:a})).modifiedCount>0};async function l(e,t,n){let r=await i(e),s="object"==typeof n&&null!==n&&Object.keys(n).some(e=>e.startsWith("$"))?n:{$set:n};return r.updateMany(t,s)}let c=async(e,t,r)=>{let{db:s}=await (0,n.connectToDatabase)();return(await s.collection(e).deleteOne({[t]:r})).deletedCount>0},d=async(e,r)=>{let{db:s}=await (0,n.connectToDatabase)();return(await s.collection(e).deleteOne({_id:new t.ObjectId(r)})).deletedCount>0};async function u(e,t){return(await i(e)).deleteMany(t)}e.s(["addRow",0,a,"deleteByField",0,c,"deleteById",0,d,"deleteManyRows",()=>u,"getAllRows",0,s,"getCollection",()=>i,"getRowByIdOrCode",0,r,"updateByField",0,o,"updateMany",()=>l])},538,e=>{"use strict";e.s(["MESSAGES_COLLECTION_NAME",0,"Messages"])},4559,e=>{"use strict";function t(e,t){let n={};return("boolean"==typeof t.isPinned&&(n[`isPinnedBy.${e}`]=t.isPinned),"boolean"==typeof t.isHidden&&(n[`isHiddenBy.${e}`]=t.isHidden),0===Object.keys(n).length)?null:n}function n(e){return Array.isArray(e)?e.filter(e=>"string"==typeof e):[]}function r(e,t){return{[`categoriesBy.${e}`]:n(t)}}function s(e,t){return{[`tagsBy.${e}`]:n(t)}}e.s(["buildToggleChatStatusFields",()=>t,"buildUpdateCategoriesFields",()=>r,"buildUpdateTagsFields",()=>s])},77584,e=>{"use strict";let t={httpOnly:!0,secure:!0,path:"/",sameSite:"lax"};function n(e,n){let{accessToken:r,refreshToken:s,sid:a,accessMaxAge:i=2592e3,refreshMaxAge:o=31536e4,sidMaxAge:l=31536e4}=n;return r&&e.cookies.set("session_token",r,{...t,maxAge:i}),a&&e.cookies.set("sid",a,{...t,maxAge:l}),s&&e.cookies.set("refresh_token",s,{...t,maxAge:o}),e}function r(e){return e.cookies.set("session_token","",{...t,maxAge:0}),e.cookies.set("sid","",{...t,maxAge:0}),e.cookies.set("refresh_token","",{...t,maxAge:0}),e}e.s(["clearAuthCookies",()=>r,"setAuthCookies",()=>n])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__a5054f99._.js.map